var vn=Object.defineProperty,On=Object.defineProperties;var Fn=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var qt=Object.prototype.hasOwnProperty,Wt=Object.prototype.propertyIsEnumerable;var Vt=(t,e,n)=>e in t?vn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,G=(t,e)=>{for(var n in e||(e={}))qt.call(e,n)&&Vt(t,n,e[n]);if(ve)for(var n of ve(e))Wt.call(e,n)&&Vt(t,n,e[n]);return t},oe=(t,e)=>On(t,Fn(e));var Oe=(t,e)=>{var n={};for(var r in t)qt.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ve)for(var r of ve(t))e.indexOf(r)<0&&Wt.call(t,r)&&(n[r]=t[r]);return n};import ie from"bn.js";var he=9e15,ce=1e9,at="0123456789abcdef",Ve="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",qe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ct={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-he,maxE:he,crypto:!1},zt,ne,L=!0,Ue="[DecimalError] ",ae=Ue+"Invalid argument: ",Qt=Ue+"Precision limit exceeded",jt=Ue+"crypto unavailable",Zt="[object Decimal]",Q=Math.floor,W=Math.pow,Vn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,qn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Wn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Jt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$=1e7,S=7,Un=9007199254740991,Gn=Ve.length-1,lt=qe.length-1,m={toStringTag:Zt};m.absoluteValue=m.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),A(t)};m.ceil=function(){return A(new this.constructor(this),this.e+1,2)};m.clampedTo=m.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(ae+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)};m.comparedTo=m.cmp=function(t){var e,n,r,i,o=this,s=o.d,u=(t=new o.constructor(t)).d,c=o.s,a=t.s;if(!s||!u)return!c||!a?NaN:c!==a?c:s===u?0:!s^c<0?1:-1;if(!s[0]||!u[0])return s[0]?c:u[0]?-a:0;if(c!==a)return c;if(o.e!==t.e)return o.e>t.e^c<0?1:-1;for(r=s.length,i=u.length,e=0,n=r<i?r:i;e<n;++e)if(s[e]!==u[e])return s[e]>u[e]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};m.cosine=m.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+S,r.rounding=1,n=Hn(r,tn(r,n)),r.precision=t,r.rounding=e,A(ne==2||ne==3?n.neg():n,t,e,!0)):new r(1):new r(NaN)};m.cubeRoot=m.cbrt=function(){var t,e,n,r,i,o,s,u,c,a,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(L=!1,o=l.s*W(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=H(l.d),t=l.e,(o=(t-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=W(n,1/3),t=Q((t+1)/3)-(t%3==(t<0?-1:2)),o==1/0?n="5e"+t:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new f(n),r.s=l.s):r=new f(o.toString()),s=(t=f.precision)+3;;)if(u=r,c=u.times(u).times(u),a=c.plus(l),r=I(a.plus(l).times(u),a.plus(c),s+2,1),H(u.d).slice(0,s)===(n=H(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(A(u,t+1,0),u.times(u).times(u).eq(l))){r=u;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(A(r,t+1,1),e=!r.times(r).times(r).eq(l));break}return L=!0,A(r,t,f.rounding,e)};m.decimalPlaces=m.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-Q(this.e/S))*S,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};m.dividedBy=m.div=function(t){return I(this,new this.constructor(t))};m.dividedToIntegerBy=m.divToInt=function(t){var e=this,n=e.constructor;return A(I(e,new n(t),0,1,1),n.precision,n.rounding)};m.equals=m.eq=function(t){return this.cmp(t)===0};m.floor=function(){return A(new this.constructor(this),this.e+1,3)};m.greaterThan=m.gt=function(t){return this.cmp(t)>0};m.greaterThanOrEqualTo=m.gte=function(t){var e=this.cmp(t);return e==1||e===0};m.hyperbolicCosine=m.cosh=function(){var t,e,n,r,i,o=this,s=o.constructor,u=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return u;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(t=Math.ceil(i/3),e=(1/He(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),o=be(s,1,o.times(e),new s(1),!0);for(var c,a=t,l=new s(8);a--;)c=o.times(o),o=u.minus(c.times(l.minus(c.times(l))));return A(o,s.precision=n,s.rounding=r,!0)};m.hyperbolicSine=m.sinh=function(){var t,e,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,n=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=be(o,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:t|0,i=i.times(1/He(5,t)),i=be(o,2,i,i,!0);for(var s,u=new o(5),c=new o(16),a=new o(20);t--;)s=i.times(i),i=i.times(u.plus(s.times(c.times(s).plus(a))))}return o.precision=e,o.rounding=n,A(i,e,n,!0)};m.hyperbolicTangent=m.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,I(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)};m.inverseCosine=m.acos=function(){var t,e=this,n=e.constructor,r=e.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?e.isNeg()?Y(n,i,o):new n(0):new n(NaN):e.isZero()?Y(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,e=e.asin(),t=Y(n,i+4,o).times(.5),n.precision=i,n.rounding=o,t.minus(e))};m.inverseHyperbolicCosine=m.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,L=!1,n=n.times(n).minus(1).sqrt().plus(n),L=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)};m.inverseHyperbolicSine=m.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,L=!1,n=n.times(n).plus(1).sqrt().plus(n),L=!0,r.precision=t,r.rounding=e,n.ln())};m.inverseHyperbolicTangent=m.atanh=function(){var t,e,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?A(new o(i),t,e,!0):(o.precision=n=r-i.e,i=I(i.plus(1),new o(1).minus(i),n+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)};m.inverseSine=m.asin=function(){var t,e,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),n=o.precision,r=o.rounding,e!==-1?e===0?(t=Y(o,n+4,r).times(.5),t.s=i.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};m.inverseTangent=m.atan=function(){var t,e,n,r,i,o,s,u,c,a=this,l=a.constructor,f=l.precision,p=l.rounding;if(a.isFinite()){if(a.isZero())return new l(a);if(a.abs().eq(1)&&f+4<=lt)return s=Y(l,f+4,p).times(.25),s.s=a.s,s}else{if(!a.s)return new l(NaN);if(f+4<=lt)return s=Y(l,f+4,p).times(.5),s.s=a.s,s}for(l.precision=u=f+10,l.rounding=1,n=Math.min(28,u/S+2|0),t=n;t;--t)a=a.div(a.times(a).plus(1).sqrt().plus(1));for(L=!1,e=Math.ceil(u/S),r=1,c=a.times(a),s=new l(a),i=a;t!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[e]!==void 0)for(t=e;s.d[t]===o.d[t]&&t--;);return n&&(s=s.times(2<<n-1)),L=!0,A(s,l.precision=f,l.rounding=p,!0)};m.isFinite=function(){return!!this.d};m.isInteger=m.isInt=function(){return!!this.d&&Q(this.e/S)>this.d.length-2};m.isNaN=function(){return!this.s};m.isNegative=m.isNeg=function(){return this.s<0};m.isPositive=m.isPos=function(){return this.s>0};m.isZero=function(){return!!this.d&&this.d[0]===0};m.lessThan=m.lt=function(t){return this.cmp(t)<0};m.lessThanOrEqualTo=m.lte=function(t){return this.cmp(t)<1};m.logarithm=m.log=function(t){var e,n,r,i,o,s,u,c,a=this,l=a.constructor,f=l.precision,p=l.rounding,d=5;if(t==null)t=new l(10),e=!0;else{if(t=new l(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new l(NaN);e=t.eq(10)}if(n=a.d,a.s<0||!n||!n[0]||a.eq(1))return new l(n&&!n[0]?-1/0:a.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(L=!1,u=f+d,s=ue(a,u),r=e?We(l,u+10):ue(t,u),c=I(s,r,u,1),Ae(c.d,i=f,p))do if(u+=10,s=ue(a,u),r=e?We(l,u+10):ue(t,u),c=I(s,r,u,1),!o){+H(c.d).slice(i+1,i+15)+1==1e14&&(c=A(c,f+1,0));break}while(Ae(c.d,i+=10,p));return L=!0,A(c,f,p)};m.minus=m.sub=function(t){var e,n,r,i,o,s,u,c,a,l,f,p,d=this,g=d.constructor;if(t=new g(t),!d.d||!t.d)return!d.s||!t.s?t=new g(NaN):d.d?t.s=-t.s:t=new g(t.d||d.s!==t.s?d:NaN),t;if(d.s!=t.s)return t.s=-t.s,d.plus(t);if(a=d.d,p=t.d,u=g.precision,c=g.rounding,!a[0]||!p[0]){if(p[0])t.s=-t.s;else if(a[0])t=new g(d);else return new g(c===3?-0:0);return L?A(t,u,c):t}if(n=Q(t.e/S),l=Q(d.e/S),a=a.slice(),o=l-n,o){for(f=o<0,f?(e=a,o=-o,s=p.length):(e=p,n=l,s=a.length),r=Math.max(Math.ceil(u/S),s)+2,o>r&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for(r=a.length,s=p.length,f=r<s,f&&(s=r),r=0;r<s;r++)if(a[r]!=p[r]){f=a[r]<p[r];break}o=0}for(f&&(e=a,a=p,p=e,t.s=-t.s),s=a.length,r=p.length-s;r>0;--r)a[s++]=0;for(r=p.length;r>o;){if(a[--r]<p[r]){for(i=r;i&&a[--i]===0;)a[i]=$-1;--a[i],a[r]+=$}a[r]-=p[r]}for(;a[--s]===0;)a.pop();for(;a[0]===0;a.shift())--n;return a[0]?(t.d=a,t.e=Ge(a,n),L?A(t,u,c):t):new g(c===3?-0:0)};m.modulo=m.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?A(new r(n),r.precision,r.rounding):(L=!1,r.modulo==9?(e=I(n,t.abs(),0,3,1),e.s*=t.s):e=I(n,t,0,r.modulo,1),e=e.times(t),L=!0,n.minus(e))};m.naturalExponential=m.exp=function(){return ft(this)};m.naturalLogarithm=m.ln=function(){return ue(this)};m.negated=m.neg=function(){var t=new this.constructor(this);return t.s=-t.s,A(t)};m.plus=m.add=function(t){var e,n,r,i,o,s,u,c,a,l,f=this,p=f.constructor;if(t=new p(t),!f.d||!t.d)return!f.s||!t.s?t=new p(NaN):f.d||(t=new p(t.d||f.s===t.s?f:NaN)),t;if(f.s!=t.s)return t.s=-t.s,f.minus(t);if(a=f.d,l=t.d,u=p.precision,c=p.rounding,!a[0]||!l[0])return l[0]||(t=new p(f)),L?A(t,u,c):t;if(o=Q(f.e/S),r=Q(t.e/S),a=a.slice(),i=o-r,i){for(i<0?(n=a,i=-i,s=l.length):(n=l,r=o,s=a.length),o=Math.ceil(u/S),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=a.length,i=l.length,s-i<0&&(i=s,n=l,l=a,a=n),e=0;i;)e=(a[--i]=a[i]+l[i]+e)/$|0,a[i]%=$;for(e&&(a.unshift(e),++r),s=a.length;a[--s]==0;)a.pop();return t.d=a,t.e=Ge(a,r),L?A(t,u,c):t};m.precision=m.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ae+t);return n.d?(e=Xt(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};m.round=function(){var t=this,e=t.constructor;return A(new e(t),t.e+1,e.rounding)};m.sine=m.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+S,r.rounding=1,n=Qn(r,tn(r,n)),r.precision=t,r.rounding=e,A(ne>2?n.neg():n,t,e,!0)):new r(NaN)};m.squareRoot=m.sqrt=function(){var t,e,n,r,i,o,s=this,u=s.d,c=s.e,a=s.s,l=s.constructor;if(a!==1||!u||!u[0])return new l(!a||a<0&&(!u||u[0])?NaN:u?s:1/0);for(L=!1,a=Math.sqrt(+s),a==0||a==1/0?(e=H(u),(e.length+c)%2==0&&(e+="0"),a=Math.sqrt(e),c=Q((c+1)/2)-(c<0||c%2),a==1/0?e="5e"+c:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+c),r=new l(e)):r=new l(a.toString()),n=(c=l.precision)+3;;)if(o=r,r=o.plus(I(s,o,n+2,1)).times(.5),H(o.d).slice(0,n)===(e=H(r.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!i&&e=="4999"){if(!i&&(A(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(A(r,c+1,1),t=!r.times(r).eq(s));break}return L=!0,A(r,c,l.rounding,t)};m.tangent=m.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=I(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,A(ne==2||ne==4?n.neg():n,t,e,!0)):new r(NaN)};m.times=m.mul=function(t){var e,n,r,i,o,s,u,c,a,l=this,f=l.constructor,p=l.d,d=(t=new f(t)).d;if(t.s*=l.s,!p||!p[0]||!d||!d[0])return new f(!t.s||p&&!p[0]&&!d||d&&!d[0]&&!p?NaN:!p||!d?t.s/0:t.s*0);for(n=Q(l.e/S)+Q(t.e/S),c=p.length,a=d.length,c<a&&(o=p,p=d,d=o,s=c,c=a,a=s),o=[],s=c+a,r=s;r--;)o.push(0);for(r=a;--r>=0;){for(e=0,i=c+r;i>r;)u=o[i]+d[r]*p[i-r-1]+e,o[i--]=u%$|0,e=u/$|0;o[i]=(o[i]+e)%$|0}for(;!o[--s];)o.pop();return e?++n:o.shift(),t.d=o,t.e=Ge(o,n),L?A(t,f.precision,f.rounding):t};m.toBinary=function(t,e){return dt(this,2,t,e)};m.toDecimalPlaces=m.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(J(t,0,ce),e===void 0?e=r.rounding:J(e,0,8),A(n,t+n.e+1,e))};m.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=te(r,!0):(J(t,0,ce),e===void 0?e=i.rounding:J(e,0,8),r=A(new i(r),t+1,e),n=te(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toFixed=function(t,e){var n,r,i=this,o=i.constructor;return t===void 0?n=te(i):(J(t,0,ce),e===void 0?e=o.rounding:J(e,0,8),r=A(new o(i),t+i.e+1,e),n=te(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};m.toFraction=function(t){var e,n,r,i,o,s,u,c,a,l,f,p,d=this,g=d.d,h=d.constructor;if(!g)return new h(d);if(a=n=new h(1),r=c=new h(0),e=new h(r),o=e.e=Xt(g)-d.e-1,s=o%S,e.d[0]=W(10,s<0?S+s:s),t==null)t=o>0?e:a;else{if(u=new h(t),!u.isInt()||u.lt(a))throw Error(ae+u);t=u.gt(e)?o>0?e:a:u}for(L=!1,u=new h(H(g)),l=h.precision,h.precision=o=g.length*S*2;f=I(u,e,0,1,1),i=n.plus(f.times(r)),i.cmp(t)!=1;)n=r,r=i,i=a,a=c.plus(f.times(i)),c=i,i=e,e=u.minus(f.times(i)),u=i;return i=I(t.minus(n),r,0,1,1),c=c.plus(i.times(a)),n=n.plus(i.times(r)),c.s=a.s=d.s,p=I(a,r,o,1).minus(d).abs().cmp(I(c,n,o,1).minus(d).abs())<1?[a,r]:[c,n],h.precision=l,L=!0,p};m.toHexadecimal=m.toHex=function(t,e){return dt(this,16,t,e)};m.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),t==null){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),e===void 0?e=r.rounding:J(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(L=!1,n=I(n,t,0,e,1).times(t),L=!0,A(n)):(t.s=n.s,n=t),n};m.toNumber=function(){return+this};m.toOctal=function(t,e){return dt(this,8,t,e)};m.toPower=m.pow=function(t){var e,n,r,i,o,s,u=this,c=u.constructor,a=+(t=new c(t));if(!u.d||!t.d||!u.d[0]||!t.d[0])return new c(W(+u,a));if(u=new c(u),u.eq(1))return u;if(r=c.precision,o=c.rounding,t.eq(1))return A(u,r,o);if(e=Q(t.e/S),e>=t.d.length-1&&(n=a<0?-a:a)<=Un)return i=Yt(c,u,n,r),t.s<0?new c(1).div(i):A(i,r,o);if(s=u.s,s<0){if(e<t.d.length-1)return new c(NaN);if((t.d[e]&1)==0&&(s=1),u.e==0&&u.d[0]==1&&u.d.length==1)return u.s=s,u}return n=W(+u,a),e=n==0||!isFinite(n)?Q(a*(Math.log("0."+H(u.d))/Math.LN10+u.e+1)):new c(n+"").e,e>c.maxE+1||e<c.minE-1?new c(e>0?s/0:0):(L=!1,c.rounding=u.s=1,n=Math.min(12,(e+"").length),i=ft(t.times(ue(u,r+n)),r),i.d&&(i=A(i,r+5,1),Ae(i.d,r,o)&&(e=r+10,i=A(ft(t.times(ue(u,e+n)),e),e+5,1),+H(i.d).slice(r+1,r+15)+1==1e14&&(i=A(i,r+1,0)))),i.s=s,L=!0,c.rounding=o,A(i,r,o))};m.toPrecision=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=te(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(J(t,1,ce),e===void 0?e=i.rounding:J(e,0,8),r=A(new i(r),t,e),n=te(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toSignificantDigits=m.toSD=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(J(t,1,ce),e===void 0?e=r.rounding:J(e,0,8)),A(new r(n),t,e)};m.toString=function(){var t=this,e=t.constructor,n=te(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};m.truncated=m.trunc=function(){return A(new this.constructor(this),this.e+1,1)};m.valueOf=m.toJSON=function(){var t=this,e=t.constructor,n=te(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function H(t){var e,n,r,i=t.length-1,o="",s=t[0];if(i>0){for(o+=s,e=1;e<i;e++)r=t[e]+"",n=S-r.length,n&&(o+=se(n)),o+=r;s=t[e],r=s+"",n=S-r.length,n&&(o+=se(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function J(t,e,n){if(t!==~~t||t<e||t>n)throw Error(ae+t)}function Ae(t,e,n,r){var i,o,s,u;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=S,i=0):(i=Math.ceil((e+1)/S),e%=S),o=W(10,S-e),u=t[i]%o|0,r==null?e<3?(e==0?u=u/100|0:e==1&&(u=u/10|0),s=n<4&&u==99999||n>3&&u==49999||u==5e4||u==0):s=(n<4&&u+1==o||n>3&&u+1==o/2)&&(t[i+1]/o/100|0)==W(10,e-2)-1||(u==o/2||u==0)&&(t[i+1]/o/100|0)==0:e<4?(e==0?u=u/1e3|0:e==1?u=u/100|0:e==2&&(u=u/10|0),s=(r||n<4)&&u==9999||!r&&n>3&&u==4999):s=((r||n<4)&&u+1==o||!r&&n>3&&u+1==o/2)&&(t[i+1]/o/1e3|0)==W(10,e-3)-1,s}function Fe(t,e,n){for(var r,i=[0],o,s=0,u=t.length;s<u;){for(o=i.length;o--;)i[o]*=e;for(i[0]+=at.indexOf(t.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function Hn(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/He(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=be(t,1,e.times(i),new t(1));for(var o=n;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=n,e}var I=function(){function t(r,i,o){var s,u=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+u,r[c]=s%o|0,u=s/o|0;return u&&r.unshift(u),r}function e(r,i,o,s){var u,c;if(o!=s)c=o>s?1:-1;else for(u=c=0;u<o;u++)if(r[u]!=i[u]){c=r[u]>i[u]?1:-1;break}return c}function n(r,i,o,s){for(var u=0;o--;)r[o]-=u,u=r[o]<i[o]?1:0,r[o]=u*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,u,c){var a,l,f,p,d,g,h,b,x,P,w,y,B,T,E,C,K,U,D,v,F=r.constructor,V=r.s==i.s?1:-1,_=r.d,R=i.d;if(!_||!_[0]||!R||!R[0])return new F(!r.s||!i.s||(_?R&&_[0]==R[0]:!R)?NaN:_&&_[0]==0||!R?V*0:V/0);for(c?(d=1,l=r.e-i.e):(c=$,d=S,l=Q(r.e/d)-Q(i.e/d)),D=R.length,K=_.length,x=new F(V),P=x.d=[],f=0;R[f]==(_[f]||0);f++);if(R[f]>(_[f]||0)&&l--,o==null?(T=o=F.precision,s=F.rounding):u?T=o+(r.e-i.e)+1:T=o,T<0)P.push(1),g=!0;else{if(T=T/d+2|0,f=0,D==1){for(p=0,R=R[0],T++;(f<K||p)&&T--;f++)E=p*c+(_[f]||0),P[f]=E/R|0,p=E%R|0;g=p||f<K}else{for(p=c/(R[0]+1)|0,p>1&&(R=t(R,p,c),_=t(_,p,c),D=R.length,K=_.length),C=D,w=_.slice(0,D),y=w.length;y<D;)w[y++]=0;v=R.slice(),v.unshift(0),U=R[0],R[1]>=c/2&&++U;do p=0,a=e(R,w,D,y),a<0?(B=w[0],D!=y&&(B=B*c+(w[1]||0)),p=B/U|0,p>1?(p>=c&&(p=c-1),h=t(R,p,c),b=h.length,y=w.length,a=e(h,w,b,y),a==1&&(p--,n(h,D<b?v:R,b,c))):(p==0&&(a=p=1),h=R.slice()),b=h.length,b<y&&h.unshift(0),n(w,h,y,c),a==-1&&(y=w.length,a=e(R,w,D,y),a<1&&(p++,n(w,D<y?v:R,y,c))),y=w.length):a===0&&(p++,w=[0]),P[f++]=p,a&&w[0]?w[y++]=_[C]||0:(w=[_[C]],y=1);while((C++<K||w[0]!==void 0)&&T--);g=w[0]!==void 0}P[0]||P.shift()}if(d==1)x.e=l,zt=g;else{for(f=1,p=P[0];p>=10;p/=10)f++;x.e=f+l*d-1,A(x,u?o+x.e+1:o,s,g)}return x}}();function A(t,e,n,r){var i,o,s,u,c,a,l,f,p,d=t.constructor;e:if(e!=null){if(f=t.d,!f)return t;for(i=1,u=f[0];u>=10;u/=10)i++;if(o=e-i,o<0)o+=S,s=e,l=f[p=0],c=l/W(10,i-s-1)%10|0;else if(p=Math.ceil((o+1)/S),u=f.length,p>=u)if(r){for(;u++<=p;)f.push(0);l=c=0,i=1,o%=S,s=o-S+1}else break e;else{for(l=u=f[p],i=1;u>=10;u/=10)i++;o%=S,s=o-S+i,c=s<0?0:l/W(10,i-s-1)%10|0}if(r=r||e<0||f[p+1]!==void 0||(s<0?l:l%W(10,i-s-1)),a=n<4?(c||r)&&(n==0||n==(t.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?l/W(10,i-s):0:f[p-1])%10&1||n==(t.s<0?8:7)),e<1||!f[0])return f.length=0,a?(e-=t.e+1,f[0]=W(10,(S-e%S)%S),t.e=-e||0):f[0]=t.e=0,t;if(o==0?(f.length=p,u=1,p--):(f.length=p+1,u=W(10,S-o),f[p]=s>0?(l/W(10,i-s)%W(10,s)|0)*u:0),a)for(;;)if(p==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=u,u=1;s>=10;s/=10)u++;o!=u&&(t.e++,f[0]==$&&(f[0]=1));break}else{if(f[p]+=u,f[p]!=$)break;f[p--]=0,u=1}for(o=f.length;f[--o]===0;)f.pop()}return L&&(t.e>d.maxE?(t.d=null,t.e=NaN):t.e<d.minE&&(t.e=0,t.d=[0])),t}function te(t,e,n){if(!t.isFinite())return en(t);var r,i=t.e,o=H(t.d),s=o.length;return e?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+se(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):i<0?(o="0."+se(-i-1)+o,n&&(r=n-s)>0&&(o+=se(r))):i>=s?(o+=se(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+se(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=se(r))),o}function Ge(t,e){var n=t[0];for(e*=S;n>=10;n/=10)e++;return e}function We(t,e,n){if(e>Gn)throw L=!0,n&&(t.precision=n),Error(Qt);return A(new t(Ve),e,1,!0)}function Y(t,e,n){if(e>lt)throw Error(Qt);return A(new t(qe),e,n,!0)}function Xt(t){var e=t.length-1,n=e*S+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function se(t){for(var e="";t--;)e+="0";return e}function Yt(t,e,n,r){var i,o=new t(1),s=Math.ceil(r/S+4);for(L=!1;;){if(n%2&&(o=o.times(e),Gt(o.d,s)&&(i=!0)),n=Q(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}e=e.times(e),Gt(e.d,s)}return L=!0,o}function Ut(t){return t.d[t.d.length-1]&1}function $t(t,e,n){for(var r,i=new t(e[0]),o=0;++o<e.length;)if(r=new t(e[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function ft(t,e){var n,r,i,o,s,u,c,a=0,l=0,f=0,p=t.constructor,d=p.rounding,g=p.precision;if(!t.d||!t.d[0]||t.e>17)return new p(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:0/0);for(e==null?(L=!1,c=g):c=e,u=new p(.03125);t.e>-2;)t=t.times(u),f+=5;for(r=Math.log(W(2,f))/Math.LN10*2+5|0,c+=r,n=o=s=new p(1),p.precision=c;;){if(o=A(o.times(t),c,1),n=n.times(++l),u=s.plus(I(o,n,c,1)),H(u.d).slice(0,c)===H(s.d).slice(0,c)){for(i=f;i--;)s=A(s.times(s),c,1);if(e==null)if(a<3&&Ae(s.d,c-r,d,a))p.precision=c+=10,n=o=u=new p(1),l=0,a++;else return A(s,p.precision=g,d,L=!0);else return p.precision=g,s}s=u}}function ue(t,e){var n,r,i,o,s,u,c,a,l,f,p,d=1,g=10,h=t,b=h.d,x=h.constructor,P=x.rounding,w=x.precision;if(h.s<0||!b||!b[0]||!h.e&&b[0]==1&&b.length==1)return new x(b&&!b[0]?-1/0:h.s!=1?NaN:b?0:h);if(e==null?(L=!1,l=w):l=e,x.precision=l+=g,n=H(b),r=n.charAt(0),Math.abs(o=h.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)h=h.times(t),n=H(h.d),r=n.charAt(0),d++;o=h.e,r>1?(h=new x("0."+n),o++):h=new x(r+"."+n.slice(1))}else return a=We(x,l+2,w).times(o+""),h=ue(new x(r+"."+n.slice(1)),l-g).plus(a),x.precision=w,e==null?A(h,w,P,L=!0):h;for(f=h,c=s=h=I(h.minus(1),h.plus(1),l,1),p=A(h.times(h),l,1),i=3;;){if(s=A(s.times(p),l,1),a=c.plus(I(s,new x(i),l,1)),H(a.d).slice(0,l)===H(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(We(x,l+2,w).times(o+""))),c=I(c,new x(d),l,1),e==null)if(Ae(c.d,l-g,P,u))x.precision=l+=g,a=s=h=I(f.minus(1),f.plus(1),l,1),p=A(h.times(h),l,1),i=u=1;else return A(c,x.precision=w,P,L=!0);else return x.precision=w,c;c=a,i+=2}}function en(t){return String(t.s*t.s/0)}function pt(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%S,n<0&&(r+=S),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=S;r<i;)t.d.push(+e.slice(r,r+=S));e=e.slice(r),r=S-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),L&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function zn(t,e){var n,r,i,o,s,u,c,a,l;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Jt.test(e))return pt(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(qn.test(e))n=16,e=e.toLowerCase();else if(Vn.test(e))n=2;else if(Wn.test(e))n=8;else throw Error(ae+e);for(o=e.search(/p/i),o>0?(c=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,r=t.constructor,s&&(e=e.replace(".",""),u=e.length,o=u-o,i=Yt(r,new r(n),o,o*2)),a=Fe(e,n,$),l=a.length-1,o=l;a[o]===0;--o)a.pop();return o<0?new r(t.s*0):(t.e=Ge(a,l),t.d=a,L=!1,s&&(t=I(t,i,u*4)),c&&(t=t.times(Math.abs(c)<54?W(2,c):ze.pow(2,c))),L=!0,t)}function Qn(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:be(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:n|0,e=e.times(1/He(5,n)),e=be(t,2,e,e);for(var i,o=new t(5),s=new t(16),u=new t(20);n--;)i=e.times(e),e=e.times(o.plus(i.times(s.times(i).minus(u))));return e}function be(t,e,n,r,i){var o,s,u,c,a=1,l=t.precision,f=Math.ceil(l/S);for(L=!1,c=n.times(n),u=new t(r);;){if(s=I(u.times(c),new t(e++*e++),l,1),u=i?r.plus(s):r.minus(s),r=I(s.times(c),new t(e++*e++),l,1),s=u.plus(r),s.d[f]!==void 0){for(o=f;s.d[o]===u.d[o]&&o--;);if(o==-1)break}o=u,u=r,r=s,s=o,a++}return L=!0,s.d.length=f+1,s}function He(t,e){for(var n=t;--e;)n*=t;return n}function tn(t,e){var n,r=e.s<0,i=Y(t,t.precision,1),o=i.times(.5);if(e=e.abs(),e.lte(o))return ne=r?4:1,e;if(n=e.divToInt(i),n.isZero())ne=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(o))return ne=Ut(n)?r?2:3:r?4:1,e;ne=Ut(n)?r?1:4:r?3:2}return e.minus(i).abs()}function dt(t,e,n,r){var i,o,s,u,c,a,l,f,p,d=t.constructor,g=n!==void 0;if(g?(J(n,1,ce),r===void 0?r=d.rounding:J(r,0,8)):(n=d.precision,r=d.rounding),!t.isFinite())l=en(t);else{for(l=te(t),s=l.indexOf("."),g?(i=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):i=e,s>=0&&(l=l.replace(".",""),p=new d(1),p.e=l.length-s,p.d=Fe(te(p),10,i),p.e=p.d.length),f=Fe(l,10,i),o=c=f.length;f[--c]==0;)f.pop();if(!f[0])l=g?"0p+0":"0";else{if(s<0?o--:(t=new d(t),t.d=f,t.e=o,t=I(t,p,n,r,0,i),f=t.d,o=t.e,a=zt),s=f[n],u=i/2,a=a||f[n+1]!==void 0,a=r<4?(s!==void 0||a)&&(r===0||r===(t.s<0?3:2)):s>u||s===u&&(r===4||a||r===6&&f[n-1]&1||r===(t.s<0?8:7)),f.length=n,a)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(c=f.length;!f[c-1];--c);for(s=0,l="";s<c;s++)l+=at.charAt(f[s]);if(g){if(c>1)if(e==16||e==8){for(s=e==16?4:3,--c;c%s;c++)l+="0";for(f=Fe(l,i,e),c=f.length;!f[c-1];--c);for(s=1,l="1.";s<c;s++)l+=at.charAt(f[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(e==16?"0x":e==2?"0b":e==8?"0o":"")+l}return t.s<0?"-"+l:l}function Gt(t,e){if(t.length>e)return t.length=e,!0}function jn(t){return new this(t).abs()}function Zn(t){return new this(t).acos()}function Jn(t){return new this(t).acosh()}function Xn(t,e){return new this(t).plus(e)}function Yn(t){return new this(t).asin()}function $n(t){return new this(t).asinh()}function er(t){return new this(t).atan()}function tr(t){return new this(t).atanh()}function nr(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,o=r+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=Y(this,o,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?Y(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=Y(this,o,1).times(.5),n.s=t.s):e.s<0?(this.precision=o,this.rounding=1,n=this.atan(I(t,e,o,1)),e=Y(this,o,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(I(t,e,o,1)),n}function rr(t){return new this(t).cbrt()}function ir(t){return A(t=new this(t),t.e+1,2)}function or(t,e,n){return new this(t).clamp(e,n)}function sr(t){if(!t||typeof t!="object")throw Error(Ue+"Object expected");var e,n,r,i=t.defaults===!0,o=["precision",1,ce,"rounding",0,8,"toExpNeg",-he,0,"toExpPos",0,he,"maxE",0,he,"minE",-he,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(n=o[e],i&&(this[n]=ct[n]),(r=t[n])!==void 0)if(Q(r)===r&&r>=o[e+1]&&r<=o[e+2])this[n]=r;else throw Error(ae+n+": "+r);if(n="crypto",i&&(this[n]=ct[n]),(r=t[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(jt);else this[n]=!1;else throw Error(ae+n+": "+r);return this}function ur(t){return new this(t).cos()}function ar(t){return new this(t).cosh()}function nn(t){var e,n,r;function i(o){var s,u,c,a=this;if(!(a instanceof i))return new i(o);if(a.constructor=i,Ht(o)){a.s=o.s,L?!o.d||o.e>i.maxE?(a.e=NaN,a.d=null):o.e<i.minE?(a.e=0,a.d=[0]):(a.e=o.e,a.d=o.d.slice()):(a.e=o.e,a.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){a.s=1/o<0?-1:1,a.e=0,a.d=[0];return}if(o<0?(o=-o,a.s=-1):a.s=1,o===~~o&&o<1e7){for(s=0,u=o;u>=10;u/=10)s++;L?s>i.maxE?(a.e=NaN,a.d=null):s<i.minE?(a.e=0,a.d=[0]):(a.e=s,a.d=[o]):(a.e=s,a.d=[o]);return}else if(o*0!==0){o||(a.s=NaN),a.e=NaN,a.d=null;return}return pt(a,o.toString())}else if(c!=="string")throw Error(ae+o);return(u=o.charCodeAt(0))===45?(o=o.slice(1),a.s=-1):(u===43&&(o=o.slice(1)),a.s=1),Jt.test(o)?pt(a,o):zn(a,o)}if(i.prototype=m,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=sr,i.clone=nn,i.isDecimal=Ht,i.abs=jn,i.acos=Zn,i.acosh=Jn,i.add=Xn,i.asin=Yn,i.asinh=$n,i.atan=er,i.atanh=tr,i.atan2=nr,i.cbrt=rr,i.ceil=ir,i.clamp=or,i.cos=ur,i.cosh=ar,i.div=cr,i.exp=lr,i.floor=fr,i.hypot=pr,i.ln=dr,i.log=mr,i.log10=hr,i.log2=gr,i.max=br,i.min=yr,i.mod=wr,i.mul=xr,i.pow=Tr,i.random=Pr,i.round=Ar,i.sign=Br,i.sin=Sr,i.sinh=Lr,i.sqrt=kr,i.sub=Cr,i.sum=Nr,i.tan=Mr,i.tanh=Er,i.trunc=Rr,t===void 0&&(t={}),t&&t.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function cr(t,e){return new this(t).div(e)}function lr(t){return new this(t).exp()}function fr(t){return A(t=new this(t),t.e+1,3)}function pr(){var t,e,n=new this(0);for(L=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return L=!0,new this(1/0);n=e}return L=!0,n.sqrt()}function Ht(t){return t instanceof ze||t&&t.toStringTag===Zt||!1}function dr(t){return new this(t).ln()}function mr(t,e){return new this(t).log(e)}function gr(t){return new this(t).log(2)}function hr(t){return new this(t).log(10)}function br(){return $t(this,arguments,"lt")}function yr(){return $t(this,arguments,"gt")}function wr(t,e){return new this(t).mod(e)}function xr(t,e){return new this(t).mul(e)}function Tr(t,e){return new this(t).pow(e)}function Pr(t){var e,n,r,i,o=0,s=new this(1),u=[];if(t===void 0?t=this.precision:J(t,1,ce),r=Math.ceil(t/S),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));o<r;)i=e[o],i>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:u[o++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);o<r;)i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((e[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,o):(u.push(i%1e7),o+=4);o=r/4}else throw Error(jt);else for(;o<r;)u[o++]=Math.random()*1e7|0;for(r=u[--o],t%=S,r&&t&&(i=W(10,S-t),u[o]=(r/i|0)*i);u[o]===0;o--)u.pop();if(o<0)n=0,u=[0];else{for(n=-1;u[0]===0;n-=S)u.shift();for(r=1,i=u[0];i>=10;i/=10)r++;r<S&&(n-=S-r)}return s.e=n,s.d=u,s}function Ar(t){return A(t=new this(t),t.e+1,this.rounding)}function Br(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function Sr(t){return new this(t).sin()}function Lr(t){return new this(t).sinh()}function kr(t){return new this(t).sqrt()}function Cr(t,e){return new this(t).sub(e)}function Nr(){var t=0,e=arguments,n=new this(e[t]);for(L=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return L=!0,A(n,this.precision,this.rounding)}function Mr(t){return new this(t).tan()}function Er(t){return new this(t).tanh()}function Rr(t){return A(t=new this(t),t.e+1,1)}m[Symbol.for("nodejs.util.inspect.custom")]=m.toString;m[Symbol.toStringTag]="Decimal";var ze=m.constructor=nn(ct);Ve=new ze(Ve);qe=new ze(qe);import oi from"big.js";import Wu from"bn.js";import{get as rn,set as _r}from"lodash";var mt=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let n=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},on={},Dr={};function j(t){let e=rn(on,t);if(!e){let n=rn(Dr,t);e=new mt({name:t,logLevel:n}),_r(on,t,e)}return e}import{MINT_SIZE as _i,TOKEN_PROGRAM_ID as Di,getTransferFeeConfig as Ki,unpackMint as Ii}from"@solana/spl-token";import{PublicKey as Kr}from"@solana/web3.js";var gt=j("CobaltX_accountInfo_util");async function sn(t,e,n){let{batchRequest:r,commitment:i="confirmed",chunkCount:o=100}=G({batchRequest:!1},n),s=ht(e,o),u=new Array(s.length).fill([]);if(r){let c=s.map(f=>{let p=t._buildArgs([f.map(d=>d.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:p}}),a=ht(c,10);u=(await(await Promise.all(a.map(async f=>await t._rpcBatchRequest(f)))).flat()).map(f=>(f.error&&gt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${f.error.message}`),f.result.value.map(p=>{if(p){let{data:d,executable:g,lamports:h,owner:b,rentEpoch:x}=p;return d.length!==2&&d[1]!=="base64"&&gt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(d[0],"base64"),executable:g,lamports:h,owner:new Kr(b),rentEpoch:x}}return null})))}else try{u=await Promise.all(s.map(c=>t.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&gt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return u.flat()}import Be from"bn.js";var un=9007199254740991;function re(t){let e=j("CobaltX_parseBigNumberish");if(t instanceof Be)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new Be(t);e.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&e.logWithError(`BigNumberish number underflow: ${t}`),(t>=un||t<=-un)&&e.logWithError(`BigNumberish number overflow: ${t}`),new Be(String(t))):typeof t=="bigint"?new Be(t.toString()):(e.error(`invalid BigNumberish value: ${t}`),new Be(0))}import{TOKEN_PROGRAM_ID as an}from"@solana/spl-token";import{PublicKey as Ir}from"@solana/web3.js";var cn={chainId:101,address:Ir.default.toBase58(),programId:an.toBase58(),decimals:9,symbol:"ETH",name:"Ethereum",logoURI:"https://raw.githubusercontent.com/cobaltx-io/tokens/main/logo/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"cobaltx",extensions:{coingeckoId:"solana"}},de={chainId:101,address:"So11111111111111111111111111111111111111112",programId:an.toBase58(),decimals:9,symbol:"WETH",name:"Wrapped ETH",logoURI:"https://raw.githubusercontent.com/cobaltx-io/tokens/main/logo/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"cobaltx",extensions:{coingeckoId:"solana"}};import{PublicKey as wt}from"@solana/web3.js";import{PublicKey as z,SystemProgram as ln,SYSVAR_RENT_PUBKEY as vr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Or}from"@solana/spl-token";function yt({pubkey:t,isSigner:e=!1,isWritable:n=!0}){return{pubkey:t,isWritable:n,isSigner:e}}var to=[yt({pubkey:Or,isWritable:!1}),yt({pubkey:ln.programId,isWritable:!1}),yt({pubkey:vr,isWritable:!1})];function fn({publicKey:t,transformSol:e}){let n=pn(t.toString());if(n instanceof z)return e&&n.equals(Se)?bt:n;if(e&&n.toString()===Se.toBase58())return bt;if(typeof n=="string"){if(n===z.default.toBase58())return z.default;try{return new z(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function pn(t){try{return new z(t)}catch{return t}}var no=new z("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ro=new z("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),io=new z("SysvarRent111111111111111111111111111111111"),oo=new z("SysvarC1ock11111111111111111111111111111111"),so=new z("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),uo=new z("Sysvar1nstructions1111111111111111111111111"),ao=ln.programId,co=new z("a2Gt18uJC8puJT9JRYQLU6rPi6okxQb4WqCjwtYshZB"),lo=new z("bXSKiFqYrALF9gJy1KqHm8tv4QXk8nCgbLN8WRsGEbh"),bt=new z("So11111111111111111111111111111111111111112"),Se=z.default,fo=new z("71kRXzJMvSeArtXYNEWa8KAjpRJosdMQ7Dpgy5Jt5zfd"),po=new z("ERFzpDteGNo8LTDKW1WwVGrkRMmA2y9WZHXNHxMA6BSV");var xt=class{constructor({mint:e,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(e===Se.toBase58()||e instanceof wt&&Se.equals(e)){this.decimals=de.decimals,this.symbol=de.symbol,this.name=de.name,this.mint=new wt(de.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=o?wt.default:fn({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},ye=xt;ye.WSOL=new xt(oe(G({},de),{mint:de.address}));var Tt=class{constructor({decimals:e,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=n,this.name=r}equals(e){return this===e}},Qe=Tt;Qe.SOL=new Tt(cn);import Fr from"toformat";var Vr=Fr,Le=Vr;import Ze from"big.js";import Wr from"bn.js";import Ur from"decimal.js-light";var je=j("module/fraction"),Pt=Le(Ze),ke=Le(Ur),Gr={[0]:ke.ROUND_DOWN,[1]:ke.ROUND_HALF_UP,[2]:ke.ROUND_UP},Hr={[0]:Ze.roundDown,[1]:Ze.roundHalfUp,[2]:Ze.roundUp},O=class{constructor(e,n=new Wr(1)){this.numerator=re(e),this.denominator=re(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new O(this.denominator,this.numerator)}add(e){let n=e instanceof O?e:new O(re(e));return this.denominator.eq(n.denominator)?new O(this.numerator.add(n.numerator),this.denominator):new O(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(e){let n=e instanceof O?e:new O(re(e));return this.denominator.eq(n.denominator)?new O(this.numerator.sub(n.numerator),this.denominator):new O(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(e){let n=e instanceof O?e:new O(re(e));return new O(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(e){let n=e instanceof O?e:new O(re(e));return new O(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(e,n={groupSeparator:""},r=1){Number.isInteger(e)||je.logWithError(`${e} is not an integer.`),e<=0&&je.logWithError(`${e} is not positive.`),ke.set({precision:e+1,rounding:Gr[r]});let i=new ke(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),n)}toFixed(e,n={groupSeparator:""},r=1){return Number.isInteger(e)||je.logWithError(`${e} is not an integer.`),e<0&&je.logWithError(`${e} is negative.`),Pt.DP=e,Pt.RM=Hr[r]||1,new Pt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,n)}isZero(){return this.numerator.isZero()}};import zr from"bn.js";var Ko=new O(new zr(100));var qo=j("CobaltX_price");function ht(t,e=1,n=[]){let r=[...t];if(e<=0)return n;for(;r.length;)n.push(r.splice(0,e));return n}import{PublicKey as ws}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ts}from"@solana/spl-token";import{ComputeBudgetProgram as hn,Keypair as yn,PublicKey as ls,Transaction as wn,TransactionMessage as Qr,VersionedTransaction as xn}from"@solana/web3.js";var X={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee"};import{TOKEN_PROGRAM_ID as jr}from"@solana/spl-token";var bn=j("CobaltX_txUtil"),Tn=1644;function Xe(t){let e=[],n=[];return t.microLamports&&(e.push(hn.setComputeUnitPrice({microLamports:t.microLamports})),n.push(X.SetComputeUnitPrice)),t.units&&(e.push(hn.setComputeUnitLimit({units:t.units})),n.push(X.SetComputeUnitLimit)),{instructions:e,instructionTypes:n}}async function we(t,e){var r,i;let n=e!=null?e:"confirmed";return(i=await((r=t.getLatestBlockhash)==null?void 0:r.call(t,{commitment:n})))==null?void 0:i.blockhash}async function Ye(t,e){return t.getSignatureStatuses([e]),new Promise((n,r)=>{let i=setTimeout(r,6e4);t.onSignature(e,o=>{if(clearTimeout(i),!o.err){n("");return}r(o.err.toString())},"confirmed")})}function Zr(t,e){t.length<1&&bn.logWithError(`no instructions provided: ${t.toString()}`),e.length<1&&bn.logWithError(`no signers provided:, ${e.toString()}`);let n=new wn;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=e[0],n.add(...t);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Tn}catch{return!1}}function Ce({instructions:t,payer:e,signers:n}){return Zr(t,[e,...n])}function Ne({instructions:t,payer:e,lookupTableAddressAccount:n,recentBlockhash:r=yn.generate().publicKey.toString()}){let o=new Qr({payerKey:e,recentBlockhash:r,instructions:t}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new xn(o).serialize()).toString("base64").length<Tn}catch{return!1}}var Jr=t=>Buffer.isBuffer(t)?t:t instanceof Uint8Array?Buffer.from(t.buffer,t.byteOffset,t.byteLength):Buffer.from(t),Xr=t=>{let e=t.serialize({requireAllSignatures:!1,verifySignatures:!1});t instanceof xn&&(e=Jr(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function me(t){let e=[];return t.forEach(n=>{n instanceof wn&&(n.recentBlockhash||(n.recentBlockhash=jr.toBase58()),n.feePayer||(n.feePayer=yn.generate().publicKey)),e.push(Xr(n))}),console.log("simulate tx string:",e),e}import{PublicKey as k}from"@solana/web3.js";var Ss=new k("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Ls=new k("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ks=new k("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Cs=new k("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ns=new k("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Ms=new k("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Es=new k("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Rs=new k("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),_s=new k("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Ds=new k("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ks=new k("2TnjBuwqyBB9to5jURagDT7jLmBPefGRiKL2yh1zPZ4V"),Is=new k("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),vs=new k("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Os=new k("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Fs=new k("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Vs=new k("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),qs=new k("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ws=new k("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Us=new k("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Gs=new k("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Hs=new k("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),zs=new k("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Yr=new k("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),$r=new k("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),ei=new k("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),Qs=new k("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ti=new k("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),js=new k("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),ni=new k("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix");var Zs={SERUM_MARKET:k.default,OPENBOOK_MARKET:new k("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:k.default,FarmV3:new k("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new k("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new k("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new k("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new k("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new k("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new k("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new k("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),Router:new k("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Yr,CREATE_CPMM_POOL_AUTH:$r,CREATE_CPMM_POOL_FEE_ACC:ei,FEE_DESTINATION_ID:new k("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR"),LOCK_CPMM_PROGRAM:ti,LCOK_CPMM_AUTH:ni};import Ys from"bn.js";import{PublicKey as Pn,AddressLookupTableAccount as $e}from"@solana/web3.js";async function At({connection:t,address:e}){let n=await sn(t,[...new Set(e.map(i=>i.toString()))].map(i=>new Pn(i))),r={};for(let i=0;i<e.length;i++){let o=n[i],s=e[i];if(!o)continue;let u=new $e({key:s,state:$e.deserialize(o.data)});r[s.toString()]=u,et[s.toString()]=u}return r}var et={AiAibtFJts8e4W1FjWYRH34aBJkJqghdmXiJozK7MvTM:new $e({key:new Pn("AiAibtFJts8e4W1FjWYRH34aBJkJqghdmXiJozK7MvTM"),state:$e.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};import{PublicKey as Me,sendAndConfirmTransaction as Bt,Transaction as Ee,TransactionMessage as Re,VersionedTransaction as _e}from"@solana/web3.js";import ii from"axios";var tt=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.api=e.api}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await ii.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(r=e==null?void 0:e[15])!=null?r:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:n,instructionTypes:r}=Xe(e);return this.instructions.unshift(...n),this.instructionTypes.unshift(...r),!0}return!1}async calComputeBudget({config:e,defaultIns:n}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:e=[],endInstructions:n=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:o=[],lookupTableAddress:s=[]}){return this.instructions.push(...e),this.endInstructions.push(...n),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...s.filter(u=>u!==Me.default.toString())),this}async versionBuild({txVersion:e,extInfo:n}){return e===0?await this.buildV0(G({},n||{})):this.build(n)}build(e){var r;let n=new Ee;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var a;let{recentBlockHash:o,skipPreflight:s=!0,sendAndConfirm:u}=i||{},c=o!=null?o:await we(this.connection,this.blockhashCommitment);if(n.recentBlockhash=c,this.signers.length&&n.sign(...this.signers),me([n]),(a=this.owner)!=null&&a.isKeyPair)return{txId:u?await Bt(this.connection,n,this.signers.find(f=>f.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(n.serialize(),{skipPreflight:s}),signedTx:n};if(this.signAllTransactions){let l=await this.signAllTransactions([n]);return{txId:await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:s}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var a;let{extraPreBuildData:n=[],extInfo:r}=e,{transaction:i}=this.build(r),o=n.filter(l=>l.transaction.instructions.length>0),s=[i,...o.map(l=>l.transaction)],u=[this.signers,...o.map(l=>l.signers)],c=[...this.instructionTypes,...o.map(l=>l.instructionTypes).flat()];return(a=this.owner)!=null&&a.signer&&u.forEach(l=>{l.some(f=>f.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:u,instructionTypes:c,execute:async l=>{var x;let{sequentially:f,onTxUpdate:p,skipTxCount:d=0,recentBlockHash:g,skipPreflight:h=!0}=l||{},b=g!=null?g:await we(this.connection,this.blockhashCommitment);if((x=this.owner)!=null&&x.isKeyPair){if(f){let P=[],w=0;for(let y of s){if(++w,w<=d)continue;let B=await Bt(this.connection,y,this.signers.find(T=>T.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:h});P.push(B)}return{txIds:P,signedTxs:s}}return{txIds:await await Promise.all(s.map(async P=>(P.recentBlockhash=b,await this.connection.sendRawTransaction(P.serialize(),{skipPreflight:h})))),signedTxs:s}}if(this.signAllTransactions){let P=s.map((y,B)=>(y.recentBlockhash=b,u[B].length&&y.sign(...u[B]),y));me(P);let w=await this.signAllTransactions(P);if(f){let y=0,B=[],T=async()=>{if(!w[y])return;let E=await this.connection.sendRawTransaction(w[y].serialize(),{skipPreflight:h});B.push({txId:E,status:"sent",signedTx:w[y]}),p==null||p([...B]),y++,this.connection.onSignature(E,C=>{let K=B.findIndex(U=>U.txId===E);K>-1&&(B[K].status=C.err?"error":"success"),p==null||p([...B]),C.err||T()},"processed"),this.connection.getSignatureStatus(E)};return await T(),{txIds:B.map(E=>E.txId),signedTxs:w}}else{let y=[];for(let B=0;B<w.length;B+=1){let T=await this.connection.sendRawTransaction(w[B].serialize(),{skipPreflight:h});y.push(T)}return{txIds:y,signedTxs:w}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:n,extInfo:r}){return n===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var h;let g=e||{},{lookupTableCache:n={},lookupTableAddress:r=[],forerunCreate:i,recentBlockhash:o}=g,s=Oe(g,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),u=G(G({},this.cluster==="devnet"?{}:et),n),c=Array.from(new Set([...r,...this.lookupTableAddress])),a=[];for(let b of c)u[b]===void 0&&a.push(new Me(b));let l=await At({connection:this.connection,address:a});for(let[b,x]of Object.entries(l))u[b]=x;let f=i?Me.default.toBase58():o!=null?o:await we(this.connection,this.blockhashCommitment),p=new Re({payerKey:this.feePayer,recentBlockhash:f,instructions:[...this.allInstructions]}).compileToV0Message();((h=this.owner)==null?void 0:h.signer)&&!this.signers.some(b=>b.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let d=new _e(p);return d.sign(this.signers),{builder:this,transaction:d,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async b=>{var w;let{skipPreflight:x=!0,sendAndConfirm:P}=b||{};if(me([d]),(w=this.owner)!=null&&w.isKeyPair){let y=await this.connection.sendTransaction(d,{skipPreflight:x});return P&&await Ye(this.connection,y),{txId:y,signedTx:d}}if(this.signAllTransactions){let y=await this.signAllTransactions([d]);return{txId:await this.connection.sendTransaction(y[0],{skipPreflight:x}),signedTx:y[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(e){var a;let{extraPreBuildData:n=[],buildProps:r}=e,{transaction:i}=await this.buildV0(r),o=n.filter(l=>l.builder.instructions.length>0),s=[i,...o.map(l=>l.transaction)],u=[this.signers,...o.map(l=>l.signers)],c=[...this.instructionTypes,...o.map(l=>l.instructionTypes).flat()];return(a=this.owner)!=null&&a.signer&&u.forEach(l=>{l.some(f=>f.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(l,f)=>{l.sign(u[f])}),{builder:this,transactions:s,signers:u,instructionTypes:c,buildProps:r,execute:async l=>{var h;let{sequentially:f,onTxUpdate:p,recentBlockHash:d,skipPreflight:g=!0}=l||{};if(d&&s.forEach(b=>b.message.recentBlockhash=d),me(s),(h=this.owner)!=null&&h.isKeyPair){if(f){let b=[];for(let x of s){let P=await this.connection.sendTransaction(x,{skipPreflight:g});await Ye(this.connection,P),b.push(P)}return{txIds:b,signedTxs:s}}return{txIds:await Promise.all(s.map(async b=>await this.connection.sendTransaction(b,{skipPreflight:g}))),signedTxs:s}}if(this.signAllTransactions){let b=await this.signAllTransactions(s);if(f){let x=0,P=[],w=async()=>{if(!b[x])return;let y=await this.connection.sendTransaction(b[x],{skipPreflight:g});P.push({txId:y,status:"sent",signedTx:b[x]}),p==null||p([...P]),x++,this.connection.onSignature(y,B=>{let T=P.findIndex(E=>E.txId===y);T>-1&&(P[T].status=B.err?"error":"success"),p==null||p([...P]),B.err||w()},"processed"),this.connection.getSignatureStatus(y)};return w(),{txIds:[],signedTxs:b}}else{let x=[];for(let P=0;P<b.length;P+=1){let w=await this.connection.sendTransaction(b[P],{skipPreflight:g});x.push(w)}return{txIds:x,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var p;let f=e||{},{splitIns:n=[],computeBudgetConfig:r}=f,i=Oe(f,["splitIns","computeBudgetConfig"]),o=r?Xe(r):{instructions:[],instructionTypes:[]},s=this.signers.reduce((d,g)=>oe(G({},d),{[g.publicKey.toBase58()]:g}),{}),u=[],c=[],a=[],l=0;if(this.allInstructions.forEach(d=>{let g=[...a,d],h=r?[...o.instructions,...g]:g,x=[...new Set(g.map(P=>P.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat()).values()].map(P=>new Me(P));if(d!==n[l]&&a.length<12&&(Ce({instructions:h,payer:this.feePayer,signers:x})||Ce({instructions:g,payer:this.feePayer,signers:x})))a.push(d);else{if(a.length===0)throw Error("item ins too big");l+=d===n[l]?1:0,Ce({instructions:r?[...o.instructions,...a]:[...a],payer:this.feePayer,signers:x})?u.push(new Ee().add(...o.instructions,...a)):u.push(new Ee().add(...a)),c.push(Array.from(new Set(a.map(P=>P.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat())).map(P=>s[P]).filter(P=>P!==void 0)),a=[d]}}),a.length>0){let g=[...new Set(a.map(h=>h.keys.filter(b=>b.isSigner).map(b=>b.pubkey.toString())).flat()).values()].map(h=>s[h]).filter(h=>h!==void 0);Ce({instructions:r?[...o.instructions,...a]:[...a],payer:this.feePayer,signers:g.map(h=>h.publicKey)})?u.push(new Ee().add(...o.instructions,...a)):u.push(new Ee().add(...a)),c.push(g)}return u.forEach(d=>d.feePayer=this.feePayer),(p=this.owner)!=null&&p.signer&&c.forEach(d=>{d.some(g=>g.publicKey.equals(this.owner.publicKey))||d.push(this.owner.signer)}),{builder:this,transactions:u,signers:c,instructionTypes:this.instructionTypes,execute:async d=>{var y;let{sequentially:g,onTxUpdate:h,skipTxCount:b=0,recentBlockHash:x,skipPreflight:P=!0}=d||{},w=x!=null?x:await we(this.connection,this.blockhashCommitment);if(u.forEach(async(B,T)=>{B.recentBlockhash=w,c[T].length&&B.sign(...c[T])}),me(u),(y=this.owner)!=null&&y.isKeyPair){if(g){let B=0,T=[];for(let E of u){if(++B,B<=b){T.push("tx skipped");continue}let C=await Bt(this.connection,E,this.signers.find(K=>K.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:P});T.push(C)}return{txIds:T,signedTxs:u}}return{txIds:await Promise.all(u.map(async B=>await this.connection.sendRawTransaction(B.serialize(),{skipPreflight:P}))),signedTxs:u}}if(this.signAllTransactions){let B=await this.signAllTransactions(u.slice(b,u.length)),T=[...u.slice(0,b),...B];if(g){let E=0,C=[],K=async()=>{if(!T[E])return;E<b&&(C.push({txId:"",status:"success",signedTx:T[E]}),h==null||h([...C]),E++,K());let U=await this.connection.sendRawTransaction(T[E].serialize(),{skipPreflight:P});C.push({txId:U,status:"sent",signedTx:T[E]}),h==null||h([...C]),E++,this.connection.onSignature(U,D=>{let v=C.findIndex(F=>F.txId===U);v>-1&&(C[v].status=D.err?"error":"success"),h==null||h([...C]),D.err||K()},"processed"),this.connection.getSignatureStatus(U)};return await K(),{txIds:C.map(U=>U.txId),signedTxs:T}}else{let E=[];for(let C=0;C<T.length;C+=1){let K=await this.connection.sendRawTransaction(T[C].serialize(),{skipPreflight:P});E.push(K)}return{txIds:E,signedTxs:T}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var w;let P=e||{},{computeBudgetConfig:n,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:o=[]}=P,s=Oe(P,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),u=G(G({},this.cluster==="devnet"?{}:et),i),c=Array.from(new Set([...this.lookupTableAddress,...o])),a=[];for(let y of c)u[y]===void 0&&a.push(new Me(y));let l=await At({connection:this.connection,address:a});for(let[y,B]of Object.entries(l))u[y]=B;let f=n?Xe(n):{instructions:[],instructionTypes:[]},p=await we(this.connection,this.blockhashCommitment),d=this.signers.reduce((y,B)=>oe(G({},y),{[B.publicKey.toBase58()]:B}),{}),g=[],h=[],b=[],x=0;if(this.allInstructions.forEach(y=>{let B=[...b,y],T=n?[...f.instructions,...B]:B;if(y!==r[x]&&b.length<12&&(Ne({instructions:T,payer:this.feePayer,lookupTableAddressAccount:u})||Ne({instructions:B,payer:this.feePayer,lookupTableAddressAccount:u})))b.push(y);else{if(b.length===0)throw Error("item ins too big");x+=y===r[x]?1:0;let E={};for(let C of[...new Set(c)])u[C]!==void 0&&(E[C]=u[C]);if(n&&Ne({instructions:[...f.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:u,recentBlockhash:p})){let C=new Re({payerKey:this.feePayer,recentBlockhash:p,instructions:[...f.instructions,...b]}).compileToV0Message(Object.values(u));g.push(new _e(C))}else{let C=new Re({payerKey:this.feePayer,recentBlockhash:p,instructions:[...b]}).compileToV0Message(Object.values(u));g.push(new _e(C))}h.push(Array.from(new Set(b.map(C=>C.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(C=>d[C]).filter(C=>C!==void 0)),b=[y]}}),b.length>0){let B=[...new Set(b.map(T=>T.keys.filter(E=>E.isSigner).map(E=>E.pubkey.toString())).flat()).values()].map(T=>d[T]).filter(T=>T!==void 0);if(n&&Ne({instructions:[...f.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:u,recentBlockhash:p})){let T=new Re({payerKey:this.feePayer,recentBlockhash:p,instructions:[...f.instructions,...b]}).compileToV0Message(Object.values(u));g.push(new _e(T))}else{let T=new Re({payerKey:this.feePayer,recentBlockhash:p,instructions:[...b]}).compileToV0Message(Object.values(u));g.push(new _e(T))}h.push(B)}return(w=this.owner)!=null&&w.signer&&h.forEach(y=>{y.some(B=>B.publicKey.equals(this.owner.publicKey))||y.push(this.owner.signer)}),{builder:this,transactions:g,buildProps:e,signers:h,instructionTypes:this.instructionTypes,execute:async y=>{var U;let{sequentially:B,onTxUpdate:T,skipTxCount:E=0,recentBlockHash:C,skipPreflight:K=!0}=y||{};if(g.map(async(D,v)=>{h[v].length&&D.sign(h[v]),C&&(D.message.recentBlockhash=C)}),me(g),(U=this.owner)!=null&&U.isKeyPair){if(B){let D=0,v=[];for(let F of g){if(++D,D<=E){console.log("skip tx: ",D),v.push("tx skipped");continue}let V=await this.connection.sendTransaction(F,{skipPreflight:K});await Ye(this.connection,V),v.push(V)}return{txIds:v,signedTxs:g}}return{txIds:await Promise.all(g.map(async D=>await this.connection.sendTransaction(D,{skipPreflight:K}))),signedTxs:g}}if(this.signAllTransactions){let D=await this.signAllTransactions(g.slice(E,g.length)),v=[...g.slice(0,E),...D];if(B){let F=0,V=[],_=async()=>{if(!v[F])return;if(F<E){V.push({txId:"",status:"success",signedTx:v[F]}),T==null||T([...V]),F++,_();return}let R=await this.connection.sendTransaction(v[F],{skipPreflight:K});V.push({txId:R,status:"sent",signedTx:v[F]}),T==null||T([...V]),F++,this.connection.onSignature(R,Ot=>{let Ft=V.findIndex(In=>In.txId===R);Ft>-1&&(V[Ft].status=Ot.err?"error":"success"),T==null||T([...V]),Ot.err||_()},"processed"),this.connection.getSignatureStatus(R)};return _(),{txIds:[],signedTxs:v}}else{let F=[];for(let V=0;V<v.length;V+=1){let _=await this.connection.sendTransaction(v[V],{skipPreflight:K});F.push(_)}return{txIds:F,signedTxs:v}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};import{PublicKey as hu}from"@solana/web3.js";import yu from"bn.js";var Xu=j("CobaltX_amount"),Yu=Le(oi);var Je=new ie(0),ga=new ie(1),ha=new ie(2),ba=new ie(3),ya=new ie(5),si=new ie(10),wa=new ie(100),xa=new ie(1e3),Ta=new ie(1e4);import{TOKEN_PROGRAM_ID as Kn}from"@solana/spl-token";import{PublicKey as Ke}from"@solana/web3.js";import Ie from"bn.js";function ui(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function St(t,...e){if(!ui(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Lt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function An(t,e){St(t);let n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var rt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ee=(t,e)=>t<<32-e|t>>>e;var Sa=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ai(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function kt(t){return typeof t=="string"&&(t=ai(t)),St(t),t}var nt=class{clone(){return this._cloneInto()}},La={}.toString;function Bn(t){let e=r=>t().update(kt(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function ci(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);let i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),u=Number(n&o),c=r?4:0,a=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+a,u,r)}var Sn=(t,e,n)=>t&e^~t&n,Ln=(t,e,n)=>t&e^t&n^e&n,it=class extends nt{constructor(e,n,r,i){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=rt(this.buffer)}update(e){Lt(this);let{view:n,buffer:r,blockLen:i}=this;e=kt(e);let o=e.length;for(let s=0;s<o;){let u=Math.min(i-this.pos,o-s);if(u===i){let c=rt(e);for(;i<=o-s;s+=i)this.process(c,s);continue}r.set(e.subarray(s,s+u),this.pos),this.pos+=u,s+=u,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Lt(this),An(e,this),this.finished=!0;let{buffer:n,view:r,blockLen:i,isLE:o}=this,{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let f=s;f<i;f++)n[f]=0;ci(r,i-8,BigInt(this.length*8),o),this.process(r,0);let u=rt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=c/4,l=this.get();if(a>l.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<a;f++)u.setUint32(4*f,l[f],o)}digest(){let{buffer:e,outputLen:n}=this;this.digestInto(e);let r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:n,buffer:r,length:i,finished:o,destroyed:s,pos:u}=this;return e.length=i,e.pos=u,e.finished=o,e.destroyed=s,i%n&&e.buffer.set(r),e}};var li=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),le=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),fe=new Uint32Array(64),Ct=class extends it{constructor(){super(64,32,8,!1),this.A=le[0]|0,this.B=le[1]|0,this.C=le[2]|0,this.D=le[3]|0,this.E=le[4]|0,this.F=le[5]|0,this.G=le[6]|0,this.H=le[7]|0}get(){let{A:e,B:n,C:r,D:i,E:o,F:s,G:u,H:c}=this;return[e,n,r,i,o,s,u,c]}set(e,n,r,i,o,s,u,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=u|0,this.H=c|0}process(e,n){for(let f=0;f<16;f++,n+=4)fe[f]=e.getUint32(n,!1);for(let f=16;f<64;f++){let p=fe[f-15],d=fe[f-2],g=ee(p,7)^ee(p,18)^p>>>3,h=ee(d,17)^ee(d,19)^d>>>10;fe[f]=h+fe[f-7]+g+fe[f-16]|0}let{A:r,B:i,C:o,D:s,E:u,F:c,G:a,H:l}=this;for(let f=0;f<64;f++){let p=ee(u,6)^ee(u,11)^ee(u,25),d=l+p+Sn(u,c,a)+li[f]+fe[f]|0,h=(ee(r,2)^ee(r,13)^ee(r,22))+Ln(r,i,o)|0;l=a,a=c,c=u,u=s+d|0,s=o,o=i,i=r,r=d+h|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,u=u+this.E|0,c=c+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,i,o,s,u,c,a,l)}roundClean(){fe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var kn=Bn(()=>new Ct);import{TOKEN_PROGRAM_ID as xi}from"@solana/spl-token";import{Keypair as Ti,PublicKey as Pi}from"@solana/web3.js";import Uc from"bn.js";import{PublicKey as yi}from"@solana/web3.js";import Mn,{isBN as Nc}from"bn.js";import{bits as fi,BitStructure as Ka,blob as pi,Blob as Ia,cstr as va,f32 as Oa,f32be as Fa,f64 as Va,f64be as qa,greedy as Wa,Layout as di,ns64 as Ua,ns64be as Ga,nu64 as Ha,nu64be as za,offset as Qa,s16 as ja,s16be as Za,s24 as Ja,s24be as Xa,s32 as Ya,s32be as $a,s40 as ec,s40be as tc,s48 as nc,s48be as rc,s8 as ic,seq as oc,struct as sc,Structure as mi,u16 as gi,u16be as uc,u24 as ac,u24be as cc,u32 as hi,u32be as lc,u40 as fc,u40be as pc,u48 as dc,u48be as mc,u8 as gc,UInt as bi,union as hc,Union as bc,unionLayoutDiscriminator as yc,utf8 as wc}from"@solana/buffer-layout";var ot=di,Cn=mi;var Nt=bi;var Nn=gi;var Mt=hi;var xe=pi;var Et=fi;var Rt=class extends ot{constructor(n,r,i){super(n,i);this.blob=xe(n),this.signed=r}decode(n,r=0){let i=new Mn(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new Mn(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}},st=class extends ot{constructor(n){super(8,n);this._lower=Et(Mt(),!1),this._upper=Et(Mt(),!1)}addBoolean(n){this._lower.fields.length<32?this._lower.addBoolean(n):this._upper.addBoolean(n)}decode(n,r=0){let i=this._lower.decode(n,r),o=this._upper.decode(n,r+this._lower.span);return G(G({},i),o)}encode(n,r,i=0){return this._lower.encode(n,r,i)+this._upper.encode(n,r,i+this._lower.span)}};function ut(t){return new Nt(1,t)}function Te(t){return new Nt(4,t)}function q(t){return new Rt(8,!1,t)}var _t=class extends ot{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function Z(t){return new _t(xe(32),e=>new yi(e),e=>e.toBuffer(),t)}var Dt=class extends Cn{decode(e,n){return super.decode(e,n)}};function Pe(t,e,n){return new Dt(t,e,n)}var wi=Pe([Z("mint"),Z("owner"),q("amount"),Te("delegateOption"),Z("delegate"),ut("state"),Te("isNativeOption"),q("isNative"),q("delegatedAmount"),Te("closeAuthorityOption"),Z("closeAuthority")]);var zc=j("CobaltX_Util");function pe({fromPublicKey:t,programId:e=xi,assignSeed:n}){let r=n?btoa(n).slice(0,32):Ti.generate().publicKey.toBase58().slice(0,32);return{publicKey:Ai(t,r,e),seed:r}}function Ai(t,e,n){let r=Buffer.concat([t.toBuffer(),Buffer.from(e),n.toBuffer()]),i=kn(r);return new Pi(i)}var Kt=(...t)=>t.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),De=class{constructor({scope:e,moduleName:n}){this.disabled=!1;this.scope=e,this.logger=j(n)}createTxBuilder(e){return this.scope.checkOwner(),new tt({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(Kt(e))}logInfo(...e){this.logger.info(Kt(e))}logAndCreateError(...e){let n=Kt(e);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{SystemProgram as ge,SYSVAR_RENT_PUBKEY as Si,Transaction as En,TransactionInstruction as Li}from"@solana/web3.js";import{createInitializeAccountInstruction as Rn,TOKEN_PROGRAM_ID as _n}from"@solana/spl-token";function Bi(t="accountFlags"){let e=new st(t);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var It=Pe([xe(5),Bi("accountFlags"),Z("ownAddress"),q("vaultSignerNonce"),Z("baseMint"),Z("quoteMint"),Z("baseVault"),q("baseDepositsTotal"),q("baseFeesAccrued"),Z("quoteVault"),q("quoteDepositsTotal"),q("quoteFeesAccrued"),q("quoteDustThreshold"),Z("requestQueue"),Z("eventQueue"),Z("bids"),Z("asks"),q("baseLotSize"),q("quoteLotSize"),q("feeRateBps"),q("referrerRebatesAccrued"),xe(7)]);function ki({programId:t,marketInfo:e}){let n=Pe([ut("version"),Te("instruction"),q("baseLotSize"),q("quoteLotSize"),Nn("feeRateBps"),q("vaultSignerNonce"),q("quoteDustThreshold")]),r=[{pubkey:e.id,isSigner:!1,isWritable:!0},{pubkey:e.requestQueue,isSigner:!1,isWritable:!0},{pubkey:e.eventQueue,isSigner:!1,isWritable:!0},{pubkey:e.bids,isSigner:!1,isWritable:!0},{pubkey:e.asks,isSigner:!1,isWritable:!0},{pubkey:e.baseVault,isSigner:!1,isWritable:!0},{pubkey:e.quoteVault,isSigner:!1,isWritable:!0},{pubkey:e.baseMint,isSigner:!1,isWritable:!1},{pubkey:e.quoteMint,isSigner:!1,isWritable:!1},{pubkey:e.authority?e.quoteMint:Si,isSigner:!1,isWritable:!1}].concat(e.authority?{pubkey:e.authority,isSigner:!1,isWritable:!1}:[]).concat(e.authority&&e.pruneAuthority?{pubkey:e.pruneAuthority,isSigner:!1,isWritable:!1}:[]),i=Buffer.alloc(n.span);return n.encode({version:0,instruction:0,baseLotSize:e.baseLotSize,quoteLotSize:e.quoteLotSize,feeRateBps:e.feeRateBps,vaultSignerNonce:e.vaultSignerNonce,quoteDustThreshold:e.quoteDustThreshold},i),new Li({keys:r,programId:t,data:i})}async function Dn({connection:t,wallet:e,marketInfo:n}){var s,u,c,a,l,f,p,d;let r=new En,i=await t.getMinimumBalanceForRentExemption(165);r.add(ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.baseVault.seed,newAccountPubkey:n.baseVault.publicKey,lamports:i,space:165,programId:_n}),ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.quoteVault.seed,newAccountPubkey:n.quoteVault.publicKey,lamports:i,space:165,programId:_n}),Rn(n.baseVault.publicKey,n.baseMint,n.vaultOwner),Rn(n.quoteVault.publicKey,n.quoteMint,n.vaultOwner),ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.id.seed,newAccountPubkey:n.id.publicKey,lamports:await t.getMinimumBalanceForRentExemption(It.span),space:It.span,programId:n.programId}));let o=new En;return o.add(ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.requestQueue.seed,newAccountPubkey:n.requestQueue.publicKey,lamports:n.lowestFeeMarket?6208320:await t.getMinimumBalanceForRentExemption((s=n.requestQueueSpace)!=null?s:5120+12),space:n.lowestFeeMarket?764:(u=n.requestQueueSpace)!=null?u:5120+12,programId:n.programId}),ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.eventQueue.seed,newAccountPubkey:n.eventQueue.publicKey,lamports:n.lowestFeeMarket?79594560:await t.getMinimumBalanceForRentExemption((c=n.eventQueueSpace)!=null?c:262144+12),space:n.lowestFeeMarket?11308:(a=n.eventQueueSpace)!=null?a:262144+12,programId:n.programId}),ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.bids.seed,newAccountPubkey:n.bids.publicKey,lamports:n.lowestFeeMarket?101977920:await t.getMinimumBalanceForRentExemption((l=n.orderbookQueueSpace)!=null?l:65536+12),space:n.lowestFeeMarket?14524:(f=n.orderbookQueueSpace)!=null?f:65536+12,programId:n.programId}),ge.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:n.asks.seed,newAccountPubkey:n.asks.publicKey,lamports:n.lowestFeeMarket?101977920:await t.getMinimumBalanceForRentExemption((p=n.orderbookQueueSpace)!=null?p:65536+12),space:n.lowestFeeMarket?14524:(d=n.orderbookQueueSpace)!=null?d:65536+12,programId:n.programId}),ki({programId:n.programId,marketInfo:{id:n.id.publicKey,requestQueue:n.requestQueue.publicKey,eventQueue:n.eventQueue.publicKey,bids:n.bids.publicKey,asks:n.asks.publicKey,baseVault:n.baseVault.publicKey,quoteVault:n.quoteVault.publicKey,baseMint:n.baseMint,quoteMint:n.quoteMint,baseLotSize:n.baseLotSize,quoteLotSize:n.quoteLotSize,feeRateBps:n.feeRateBps,vaultSignerNonce:n.vaultSignerNonce,quoteDustThreshold:n.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[X.CreateAccount,X.CreateAccount,X.InitAccount,X.InitAccount]},{transaction:o,signer:[],instructionTypes:[X.CreateAccount,X.CreateAccount,X.CreateAccount,X.CreateAccount,X.CreateAccount,X.InitMarket]}]}var vt=class extends De{async create({baseInfo:e,quoteInfo:n,lotSize:r,tickSize:i,dexProgramId:o,requestQueueSpace:s,eventQueueSpace:u,orderbookQueueSpace:c,lowestFeeMarket:a,assignSeed:l,txVersion:f,computeBudgetConfig:p}){let d=this.scope.ownerPubKey,g=l?`${e.mint.toBase58().slice(0,10)}-${n.mint.toBase58().slice(0,10)}-${l}`:void 0,h=pe({fromPublicKey:d,programId:o,assignSeed:g&&`${g}-market`}),b=pe({fromPublicKey:d,programId:o,assignSeed:g&&`${g}-request`}),x=pe({fromPublicKey:d,programId:o,assignSeed:g&&`${g}-event`}),P=pe({fromPublicKey:d,programId:o,assignSeed:g&&`${g}-bids`}),w=pe({fromPublicKey:d,programId:o,assignSeed:g&&`${g}-asks`}),y=pe({fromPublicKey:d,programId:Kn,assignSeed:g&&`${g}-baseVault`}),B=pe({fromPublicKey:d,programId:Kn,assignSeed:g&&`${g}-quoteVault`}),T=0,E=new Ie(100);function C(){let _=new Ie(0);for(;;)try{return{vaultOwner:Ke.createProgramAddressSync([h.publicKey.toBuffer(),_.toArrayLike(Buffer,"le",8)],o),vaultSignerNonce:_}}catch{if(_.iaddn(1),_.gt(new Ie(25555)))throw Error("find vault owner error")}}let{vaultOwner:K,vaultSignerNonce:U}=C(),D=new Ie(Math.round(10**e.decimals*r)),v=new Ie(Math.round(r*10**n.decimals*i));if(D.eq(Je))throw Error("lot size is too small");if(v.eq(Je))throw Error("tick size or lot size is too small");let F=await Dn({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:o,id:h,baseMint:e.mint,quoteMint:n.mint,baseVault:y,quoteVault:B,vaultOwner:K,requestQueue:b,eventQueue:x,bids:P,asks:w,feeRateBps:T,quoteDustThreshold:E,vaultSignerNonce:U,baseLotSize:D,quoteLotSize:v,requestQueueSpace:s,eventQueueSpace:u,orderbookQueueSpace:c,lowestFeeMarket:a}}),V=this.createTxBuilder();V.addInstruction({instructions:F[0].transaction.instructions,signers:F[0].signer});for await(let _ of F.slice(1,F.length))V.addInstruction({instructions:_.transaction.instructions,signers:_.signer,instructionTypes:_.instructionTypes});return f===0?V.sizeCheckBuildV0({computeBudgetConfig:p,address:{marketId:h.publicKey,requestQueue:b.publicKey,eventQueue:x.publicKey,bids:P.publicKey,asks:w.publicKey,baseVault:y.publicKey,quoteVault:B.publicKey,baseMint:new Ke(e.mint),quoteMin:new Ke(n.mint)}}):V.sizeCheckBuild({computeBudgetConfig:p,address:{marketId:h.publicKey,requestQueue:b.publicKey,eventQueue:x.publicKey,bids:P.publicKey,asks:w.publicKey,baseVault:y.publicKey,quoteVault:B.publicKey,baseMint:new Ke(e.mint),quoteMin:new Ke(n.mint)}})}};export{vt as default};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=createMarket.mjs.map