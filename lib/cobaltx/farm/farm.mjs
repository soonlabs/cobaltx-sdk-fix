var On=Object.defineProperty,Wn=Object.defineProperties;var Un=Object.getOwnPropertyDescriptors;var st=Object.getOwnPropertySymbols;var Rr=Object.prototype.hasOwnProperty,Kr=Object.prototype.propertyIsEnumerable;var Br=(e,t,r)=>t in e?On(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,X=(e,t)=>{for(var r in t||(t={}))Rr.call(t,r)&&Br(e,r,t[r]);if(st)for(var r of st(t))Kr.call(t,r)&&Br(e,r,t[r]);return e},ee=(e,t)=>Wn(e,Un(t));var at=(e,t)=>{var r={};for(var n in e)Rr.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&st)for(var n of st(e))t.indexOf(n)<0&&Kr.call(e,n)&&(r[n]=e[n]);return r};import{MINT_SIZE as fs,TOKEN_PROGRAM_ID as ps,getTransferFeeConfig as ms,unpackMint as gs}from"@solana/spl-token";import{PublicKey as Hn}from"@solana/web3.js";import{get as Cr,set as qn}from"lodash";var Ft=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let r=t.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(r)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Vr={},Gn={};function Q(e){let t=Cr(Vr,e);if(!t){let r=Cr(Gn,e);t=new Ft({name:e,logLevel:r}),qn(Vr,e,t)}return t}var Et=Q("CobaltX_accountInfo_util");async function Fr(e,t,r){let{batchRequest:n,commitment:o="confirmed",chunkCount:i=100}=X({batchRequest:!1},r),s=_t(t,i),a=new Array(s.length).fill([]);if(n){let c=s.map(d=>{let f=e._buildArgs([d.map(p=>p.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:f}}),u=_t(c,10);a=(await(await Promise.all(u.map(async d=>await e._rpcBatchRequest(d)))).flat()).map(d=>(d.error&&Et.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${d.error.message}`),d.result.value.map(f=>{if(f){let{data:p,executable:m,lamports:y,owner:b,rentEpoch:P}=f;return p.length!==2&&p[1]!=="base64"&&Et.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:m,lamports:y,owner:new Hn(b),rentEpoch:P}}return null})))}else try{a=await Promise.all(s.map(c=>e.getMultipleAccountsInfo(c,o)))}catch(c){c instanceof Error&&Et.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}import xe from"bn.js";var _e=9e15,Le=1e9,Mt="0123456789abcdef",lt="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",dt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Nt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-_e,maxE:_e,crypto:!1},Nr,ye,V=!0,pt="[DecimalError] ",Se=pt+"Invalid argument: ",vr=pt+"Precision limit exceeded",Dr=pt+"crypto unavailable",Or="[object Decimal]",ie=Math.floor,te=Math.pow,jn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,zn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Zn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Wr=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,de=1e7,B=7,Xn=9007199254740991,Jn=lt.length-1,vt=dt.length-1,h={toStringTag:Or};h.absoluteValue=h.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),S(e)};h.ceil=function(){return S(new this.constructor(this),this.e+1,2)};h.clampedTo=h.clamp=function(e,t){var r,n=this,o=n.constructor;if(e=new o(e),t=new o(t),!e.s||!t.s)return new o(NaN);if(e.gt(t))throw Error(Se+t);return r=n.cmp(e),r<0?e:n.cmp(t)>0?t:new o(n)};h.comparedTo=h.cmp=function(e){var t,r,n,o,i=this,s=i.d,a=(e=new i.constructor(e)).d,c=i.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(i.e!==e.e)return i.e>e.e^c<0?1:-1;for(n=s.length,o=a.length,t=0,r=n<o?n:o;t<r;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return n===o?0:n>o^c<0?1:-1};h.cosine=h.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+B,n.rounding=1,r=Yn(n,jr(n,r)),n.precision=e,n.rounding=t,S(ye==2||ye==3?r.neg():r,e,t,!0)):new n(1):new n(NaN)};h.cubeRoot=h.cbrt=function(){var e,t,r,n,o,i,s,a,c,u,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(V=!1,i=l.s*te(l.s*l,1/3),!i||Math.abs(i)==1/0?(r=ne(l.d),e=l.e,(i=(e-r.length+1)%3)&&(r+=i==1||i==-2?"0":"00"),i=te(r,1/3),e=ie((e+1)/3)-(e%3==(e<0?-1:2)),i==1/0?r="5e"+e:(r=i.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new d(r),n.s=l.s):n=new d(i.toString()),s=(e=d.precision)+3;;)if(a=n,c=a.times(a).times(a),u=c.plus(l),n=z(u.plus(l).times(a),u.plus(c),s+2,1),ne(a.d).slice(0,s)===(r=ne(n.d)).slice(0,s))if(r=r.slice(s-3,s+1),r=="9999"||!o&&r=="4999"){if(!o&&(S(a,e+1,0),a.times(a).times(a).eq(l))){n=a;break}s+=4,o=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(S(n,e+1,1),t=!n.times(n).times(n).eq(l));break}return V=!0,S(n,e,d.rounding,t)};h.decimalPlaces=h.dp=function(){var e,t=this.d,r=NaN;if(t){if(e=t.length-1,r=(e-ie(this.e/B))*B,e=t[e],e)for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r};h.dividedBy=h.div=function(e){return z(this,new this.constructor(e))};h.dividedToIntegerBy=h.divToInt=function(e){var t=this,r=t.constructor;return S(z(t,new r(e),0,1,1),r.precision,r.rounding)};h.equals=h.eq=function(e){return this.cmp(e)===0};h.floor=function(){return S(new this.constructor(this),this.e+1,3)};h.greaterThan=h.gt=function(e){return this.cmp(e)>0};h.greaterThanOrEqualTo=h.gte=function(e){var t=this.cmp(e);return t==1||t===0};h.hyperbolicCosine=h.cosh=function(){var e,t,r,n,o,i=this,s=i.constructor,a=new s(1);if(!i.isFinite())return new s(i.s?1/0:NaN);if(i.isZero())return a;r=s.precision,n=s.rounding,s.precision=r+Math.max(i.e,i.sd())+4,s.rounding=1,o=i.d.length,o<32?(e=Math.ceil(o/3),t=(1/gt(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),i=Me(s,1,i.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=i.times(i),i=a.minus(c.times(l.minus(c.times(l))));return S(i,s.precision=r,s.rounding=n,!0)};h.hyperbolicSine=h.sinh=function(){var e,t,r,n,o=this,i=o.constructor;if(!o.isFinite()||o.isZero())return new i(o);if(t=i.precision,r=i.rounding,i.precision=t+Math.max(o.e,o.sd())+4,i.rounding=1,n=o.d.length,n<3)o=Me(i,2,o,o,!0);else{e=1.4*Math.sqrt(n),e=e>16?16:e|0,o=o.times(1/gt(5,e)),o=Me(i,2,o,o,!0);for(var s,a=new i(5),c=new i(16),u=new i(20);e--;)s=o.times(o),o=o.times(a.plus(s.times(c.times(s).plus(u))))}return i.precision=t,i.rounding=r,S(o,t,r,!0)};h.hyperbolicTangent=h.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,z(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)};h.inverseCosine=h.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),o=r.precision,i=r.rounding;return n!==-1?n===0?t.isNeg()?le(r,o,i):new r(0):new r(NaN):t.isZero()?le(r,o+4,i).times(.5):(r.precision=o+6,r.rounding=1,t=t.asin(),e=le(r,o+4,i).times(.5),r.precision=o,r.rounding=i,e.minus(t))};h.inverseHyperbolicCosine=h.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,V=!1,r=r.times(r).minus(1).sqrt().plus(r),V=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)};h.inverseHyperbolicSine=h.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,V=!1,r=r.times(r).plus(1).sqrt().plus(r),V=!0,n.precision=e,n.rounding=t,r.ln())};h.inverseHyperbolicTangent=h.atanh=function(){var e,t,r,n,o=this,i=o.constructor;return o.isFinite()?o.e>=0?new i(o.abs().eq(1)?o.s/0:o.isZero()?o:NaN):(e=i.precision,t=i.rounding,n=o.sd(),Math.max(n,e)<2*-o.e-1?S(new i(o),e,t,!0):(i.precision=r=n-o.e,o=z(o.plus(1),new i(1).minus(o),r+e,1),i.precision=e+4,i.rounding=1,o=o.ln(),i.precision=e,i.rounding=t,o.times(.5))):new i(NaN)};h.inverseSine=h.asin=function(){var e,t,r,n,o=this,i=o.constructor;return o.isZero()?new i(o):(t=o.abs().cmp(1),r=i.precision,n=i.rounding,t!==-1?t===0?(e=le(i,r+4,n).times(.5),e.s=o.s,e):new i(NaN):(i.precision=r+6,i.rounding=1,o=o.div(new i(1).minus(o.times(o)).sqrt().plus(1)).atan(),i.precision=r,i.rounding=n,o.times(2)))};h.inverseTangent=h.atan=function(){var e,t,r,n,o,i,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&d+4<=vt)return s=le(l,d+4,f).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(d+4<=vt)return s=le(l,d+4,f).times(.5),s.s=u.s,s}for(l.precision=a=d+10,l.rounding=1,r=Math.min(28,a/B+2|0),e=r;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(V=!1,t=Math.ceil(a/B),n=1,c=u.times(u),s=new l(u),o=u;e!==-1;)if(o=o.times(c),i=s.minus(o.div(n+=2)),o=o.times(c),s=i.plus(o.div(n+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===i.d[e]&&e--;);return r&&(s=s.times(2<<r-1)),V=!0,S(s,l.precision=d,l.rounding=f,!0)};h.isFinite=function(){return!!this.d};h.isInteger=h.isInt=function(){return!!this.d&&ie(this.e/B)>this.d.length-2};h.isNaN=function(){return!this.s};h.isNegative=h.isNeg=function(){return this.s<0};h.isPositive=h.isPos=function(){return this.s>0};h.isZero=function(){return!!this.d&&this.d[0]===0};h.lessThan=h.lt=function(e){return this.cmp(e)<0};h.lessThanOrEqualTo=h.lte=function(e){return this.cmp(e)<1};h.logarithm=h.log=function(e){var t,r,n,o,i,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding,p=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),r=e.d,e.s<0||!r||!r[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new l(r&&!r[0]?-1/0:u.s!=1?NaN:r?0:1/0);if(t)if(r.length>1)i=!0;else{for(o=r[0];o%10===0;)o/=10;i=o!==1}if(V=!1,a=d+p,s=Ie(u,a),n=t?ft(l,a+10):Ie(e,a),c=z(s,n,a,1),Ue(c.d,o=d,f))do if(a+=10,s=Ie(u,a),n=t?ft(l,a+10):Ie(e,a),c=z(s,n,a,1),!i){+ne(c.d).slice(o+1,o+15)+1==1e14&&(c=S(c,d+1,0));break}while(Ue(c.d,o+=10,f));return V=!0,S(c,d,f)};h.minus=h.sub=function(e){var t,r,n,o,i,s,a,c,u,l,d,f,p=this,m=p.constructor;if(e=new m(e),!p.d||!e.d)return!p.s||!e.s?e=new m(NaN):p.d?e.s=-e.s:e=new m(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(u=p.d,f=e.d,a=m.precision,c=m.rounding,!u[0]||!f[0]){if(f[0])e.s=-e.s;else if(u[0])e=new m(p);else return new m(c===3?-0:0);return V?S(e,a,c):e}if(r=ie(e.e/B),l=ie(p.e/B),u=u.slice(),i=l-r,i){for(d=i<0,d?(t=u,i=-i,s=f.length):(t=f,r=l,s=u.length),n=Math.max(Math.ceil(a/B),s)+2,i>n&&(i=n,t.length=1),t.reverse(),n=i;n--;)t.push(0);t.reverse()}else{for(n=u.length,s=f.length,d=n<s,d&&(s=n),n=0;n<s;n++)if(u[n]!=f[n]){d=u[n]<f[n];break}i=0}for(d&&(t=u,u=f,f=t,e.s=-e.s),s=u.length,n=f.length-s;n>0;--n)u[s++]=0;for(n=f.length;n>i;){if(u[--n]<f[n]){for(o=n;o&&u[--o]===0;)u[o]=de-1;--u[o],u[n]+=de}u[n]-=f[n]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(e.d=u,e.e=mt(u,r),V?S(e,a,c):e):new m(c===3?-0:0)};h.modulo=h.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?S(new n(r),n.precision,n.rounding):(V=!1,n.modulo==9?(t=z(r,e.abs(),0,3,1),t.s*=e.s):t=z(r,e,0,n.modulo,1),t=t.times(e),V=!0,r.minus(t))};h.naturalExponential=h.exp=function(){return Dt(this)};h.naturalLogarithm=h.ln=function(){return Ie(this)};h.negated=h.neg=function(){var e=new this.constructor(this);return e.s=-e.s,S(e)};h.plus=h.add=function(e){var t,r,n,o,i,s,a,c,u,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,l=e.d,a=f.precision,c=f.rounding,!u[0]||!l[0])return l[0]||(e=new f(d)),V?S(e,a,c):e;if(i=ie(d.e/B),n=ie(e.e/B),u=u.slice(),o=i-n,o){for(o<0?(r=u,o=-o,s=l.length):(r=l,n=i,s=u.length),i=Math.ceil(a/B),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=u.length,o=l.length,s-o<0&&(o=s,r=l,l=u,u=r),t=0;o;)t=(u[--o]=u[o]+l[o]+t)/de|0,u[o]%=de;for(t&&(u.unshift(t),++n),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=mt(u,n),V?S(e,a,c):e};h.precision=h.sd=function(e){var t,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Se+e);return r.d?(t=Ur(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t};h.round=function(){var e=this,t=e.constructor;return S(new t(e),e.e+1,t.rounding)};h.sine=h.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+B,n.rounding=1,r=$n(n,jr(n,r)),n.precision=e,n.rounding=t,S(ye>2?r.neg():r,e,t,!0)):new n(NaN)};h.squareRoot=h.sqrt=function(){var e,t,r,n,o,i,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(V=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=ne(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=ie((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),n=new l(t)):n=new l(u.toString()),r=(c=l.precision)+3;;)if(i=n,n=i.plus(z(s,i,r+2,1)).times(.5),ne(i.d).slice(0,r)===(t=ne(n.d)).slice(0,r))if(t=t.slice(r-3,r+1),t=="9999"||!o&&t=="4999"){if(!o&&(S(i,c+1,0),i.times(i).eq(s))){n=i;break}r+=4,o=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(S(n,c+1,1),e=!n.times(n).eq(s));break}return V=!0,S(n,c,l.rounding,e)};h.tangent=h.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,r=r.sin(),r.s=1,r=z(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,S(ye==2||ye==4?r.neg():r,e,t,!0)):new n(NaN)};h.times=h.mul=function(e){var t,r,n,o,i,s,a,c,u,l=this,d=l.constructor,f=l.d,p=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!p||!p[0])return new d(!e.s||f&&!f[0]&&!p||p&&!p[0]&&!f?NaN:!f||!p?e.s/0:e.s*0);for(r=ie(l.e/B)+ie(e.e/B),c=f.length,u=p.length,c<u&&(i=f,f=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,o=c+n;o>n;)a=i[o]+p[n]*f[o-n-1]+t,i[o--]=a%de|0,t=a/de|0;i[o]=(i[o]+t)%de|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=mt(i,r),V?S(e,d.precision,d.rounding):e};h.toBinary=function(e,t){return Wt(this,2,e,t)};h.toDecimalPlaces=h.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ae(e,0,Le),t===void 0?t=n.rounding:ae(t,0,8),S(r,e+r.e+1,t))};h.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=pe(n,!0):(ae(e,0,Le),t===void 0?t=o.rounding:ae(t,0,8),n=S(new o(n),e+1,t),r=pe(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r};h.toFixed=function(e,t){var r,n,o=this,i=o.constructor;return e===void 0?r=pe(o):(ae(e,0,Le),t===void 0?t=i.rounding:ae(t,0,8),n=S(new i(o),e+o.e+1,t),r=pe(n,!1,e+n.e+1)),o.isNeg()&&!o.isZero()?"-"+r:r};h.toFraction=function(e){var t,r,n,o,i,s,a,c,u,l,d,f,p=this,m=p.d,y=p.constructor;if(!m)return new y(p);if(u=r=new y(1),n=c=new y(0),t=new y(n),i=t.e=Ur(m)-p.e-1,s=i%B,t.d[0]=te(10,s<0?B+s:s),e==null)e=i>0?t:u;else{if(a=new y(e),!a.isInt()||a.lt(u))throw Error(Se+a);e=a.gt(t)?i>0?t:u:a}for(V=!1,a=new y(ne(m)),l=y.precision,y.precision=i=m.length*B*2;d=z(a,t,0,1,1),o=r.plus(d.times(n)),o.cmp(e)!=1;)r=n,n=o,o=u,u=c.plus(d.times(o)),c=o,o=t,t=a.minus(d.times(o)),a=o;return o=z(e.minus(r),n,0,1,1),c=c.plus(o.times(u)),r=r.plus(o.times(n)),c.s=u.s=p.s,f=z(u,n,i,1).minus(p).abs().cmp(z(c,r,i,1).minus(p).abs())<1?[u,n]:[c,r],y.precision=l,V=!0,f};h.toHexadecimal=h.toHex=function(e,t){return Wt(this,16,e,t)};h.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),e==null){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),t===void 0?t=n.rounding:ae(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(V=!1,r=z(r,e,0,t,1).times(e),V=!0,S(r)):(e.s=r.s,r=e),r};h.toNumber=function(){return+this};h.toOctal=function(e,t){return Wt(this,8,e,t)};h.toPower=h.pow=function(e){var t,r,n,o,i,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(te(+a,u));if(a=new c(a),a.eq(1))return a;if(n=c.precision,i=c.rounding,e.eq(1))return S(a,n,i);if(t=ie(e.e/B),t>=e.d.length-1&&(r=u<0?-u:u)<=Xn)return o=qr(c,a,r,n),e.s<0?new c(1).div(o):S(o,n,i);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return r=te(+a,u),t=r==0||!isFinite(r)?ie(u*(Math.log("0."+ne(a.d))/Math.LN10+a.e+1)):new c(r+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(V=!1,c.rounding=a.s=1,r=Math.min(12,(t+"").length),o=Dt(e.times(Ie(a,n+r)),n),o.d&&(o=S(o,n+5,1),Ue(o.d,n,i)&&(t=n+10,o=S(Dt(e.times(Ie(a,t+r)),t),t+5,1),+ne(o.d).slice(n+1,n+15)+1==1e14&&(o=S(o,n+1,0)))),o.s=s,V=!0,c.rounding=i,S(o,n,i))};h.toPrecision=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=pe(n,n.e<=o.toExpNeg||n.e>=o.toExpPos):(ae(e,1,Le),t===void 0?t=o.rounding:ae(t,0,8),n=S(new o(n),e,t),r=pe(n,e<=n.e||n.e<=o.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r};h.toSignificantDigits=h.toSD=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ae(e,1,Le),t===void 0?t=n.rounding:ae(t,0,8)),S(new n(r),e,t)};h.toString=function(){var e=this,t=e.constructor,r=pe(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r};h.truncated=h.trunc=function(){return S(new this.constructor(this),this.e+1,1)};h.valueOf=h.toJSON=function(){var e=this,t=e.constructor,r=pe(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};function ne(e){var t,r,n,o=e.length-1,i="",s=e[0];if(o>0){for(i+=s,t=1;t<o;t++)n=e[t]+"",r=B-n.length,r&&(i+=Ae(r)),i+=n;s=e[t],n=s+"",r=B-n.length,r&&(i+=Ae(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}function ae(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Se+e)}function Ue(e,t,r,n){var o,i,s,a;for(i=e[0];i>=10;i/=10)--t;return--t<0?(t+=B,o=0):(o=Math.ceil((t+1)/B),t%=B),i=te(10,B-t),a=e[o]%i|0,n==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=r<4&&a==99999||r>3&&a==49999||a==5e4||a==0):s=(r<4&&a+1==i||r>3&&a+1==i/2)&&(e[o+1]/i/100|0)==te(10,t-2)-1||(a==i/2||a==0)&&(e[o+1]/i/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(n||r<4)&&a==9999||!n&&r>3&&a==4999):s=((n||r<4)&&a+1==i||!n&&r>3&&a+1==i/2)&&(e[o+1]/i/1e3|0)==te(10,t-3)-1,s}function ct(e,t,r){for(var n,o=[0],i,s=0,a=e.length;s<a;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=Mt.indexOf(e.charAt(s++)),n=0;n<o.length;n++)o[n]>r-1&&(o[n+1]===void 0&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}function Yn(e,t){var r,n,o;if(t.isZero())return t;n=t.d.length,n<32?(r=Math.ceil(n/3),o=(1/gt(4,r)).toString()):(r=16,o="2.3283064365386962890625e-10"),e.precision+=r,t=Me(e,1,t.times(o),new e(1));for(var i=r;i--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=r,t}var z=function(){function e(n,o,i){var s,a=0,c=n.length;for(n=n.slice();c--;)s=n[c]*o+a,n[c]=s%i|0,a=s/i|0;return a&&n.unshift(a),n}function t(n,o,i,s){var a,c;if(i!=s)c=i>s?1:-1;else for(a=c=0;a<i;a++)if(n[a]!=o[a]){c=n[a]>o[a]?1:-1;break}return c}function r(n,o,i,s){for(var a=0;i--;)n[i]-=a,a=n[i]<o[i]?1:0,n[i]=a*s+n[i]-o[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,i,s,a,c){var u,l,d,f,p,m,y,b,P,I,w,T,A,k,C,R,L,U,O,M,K=n.constructor,q=n.s==o.s?1:-1,H=n.d,W=o.d;if(!H||!H[0]||!W||!W[0])return new K(!n.s||!o.s||(H?W&&H[0]==W[0]:!W)?NaN:H&&H[0]==0||!W?q*0:q/0);for(c?(p=1,l=n.e-o.e):(c=de,p=B,l=ie(n.e/p)-ie(o.e/p)),O=W.length,L=H.length,P=new K(q),I=P.d=[],d=0;W[d]==(H[d]||0);d++);if(W[d]>(H[d]||0)&&l--,i==null?(k=i=K.precision,s=K.rounding):a?k=i+(n.e-o.e)+1:k=i,k<0)I.push(1),m=!0;else{if(k=k/p+2|0,d=0,O==1){for(f=0,W=W[0],k++;(d<L||f)&&k--;d++)C=f*c+(H[d]||0),I[d]=C/W|0,f=C%W|0;m=f||d<L}else{for(f=c/(W[0]+1)|0,f>1&&(W=e(W,f,c),H=e(H,f,c),O=W.length,L=H.length),R=O,w=H.slice(0,O),T=w.length;T<O;)w[T++]=0;M=W.slice(),M.unshift(0),U=W[0],W[1]>=c/2&&++U;do f=0,u=t(W,w,O,T),u<0?(A=w[0],O!=T&&(A=A*c+(w[1]||0)),f=A/U|0,f>1?(f>=c&&(f=c-1),y=e(W,f,c),b=y.length,T=w.length,u=t(y,w,b,T),u==1&&(f--,r(y,O<b?M:W,b,c))):(f==0&&(u=f=1),y=W.slice()),b=y.length,b<T&&y.unshift(0),r(w,y,T,c),u==-1&&(T=w.length,u=t(W,w,O,T),u<1&&(f++,r(w,O<T?M:W,T,c))),T=w.length):u===0&&(f++,w=[0]),I[d++]=f,u&&w[0]?w[T++]=H[R]||0:(w=[H[R]],T=1);while((R++<L||w[0]!==void 0)&&k--);m=w[0]!==void 0}I[0]||I.shift()}if(p==1)P.e=l,Nr=m;else{for(d=1,f=I[0];f>=10;f/=10)d++;P.e=d+l*p-1,S(P,a?i+P.e+1:i,s,m)}return P}}();function S(e,t,r,n){var o,i,s,a,c,u,l,d,f,p=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(o=1,a=d[0];a>=10;a/=10)o++;if(i=t-o,i<0)i+=B,s=t,l=d[f=0],c=l/te(10,o-s-1)%10|0;else if(f=Math.ceil((i+1)/B),a=d.length,f>=a)if(n){for(;a++<=f;)d.push(0);l=c=0,o=1,i%=B,s=i-B+1}else break e;else{for(l=a=d[f],o=1;a>=10;a/=10)o++;i%=B,s=i-B+o,c=s<0?0:l/te(10,o-s-1)%10|0}if(n=n||t<0||d[f+1]!==void 0||(s<0?l:l%te(10,o-s-1)),u=r<4?(c||n)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||n||r==6&&(i>0?s>0?l/te(10,o-s):0:d[f-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=te(10,(B-t%B)%B),e.e=-t||0):d[0]=e.e=0,e;if(i==0?(d.length=f,a=1,f--):(d.length=f+1,a=te(10,B-i),d[f]=s>0?(l/te(10,o-s)%te(10,s)|0)*a:0),u)for(;;)if(f==0){for(i=1,s=d[0];s>=10;s/=10)i++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;i!=a&&(e.e++,d[0]==de&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=de)break;d[f--]=0,a=1}for(i=d.length;d[--i]===0;)d.pop()}return V&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function pe(e,t,r){if(!e.isFinite())return Hr(e);var n,o=e.e,i=ne(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Ae(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(e.e<0?"e":"e+")+e.e):o<0?(i="0."+Ae(-o-1)+i,r&&(n=r-s)>0&&(i+=Ae(n))):o>=s?(i+=Ae(o+1-s),r&&(n=r-o-1)>0&&(i=i+"."+Ae(n))):((n=o+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(o+1===s&&(i+="."),i+=Ae(n))),i}function mt(e,t){var r=e[0];for(t*=B;r>=10;r/=10)t++;return t}function ft(e,t,r){if(t>Jn)throw V=!0,r&&(e.precision=r),Error(vr);return S(new e(lt),t,1,!0)}function le(e,t,r){if(t>vt)throw Error(vr);return S(new e(dt),t,r,!0)}function Ur(e){var t=e.length-1,r=t*B+1;if(t=e[t],t){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function Ae(e){for(var t="";e--;)t+="0";return t}function qr(e,t,r,n){var o,i=new e(1),s=Math.ceil(n/B+4);for(V=!1;;){if(r%2&&(i=i.times(t),_r(i.d,s)&&(o=!0)),r=ie(r/2),r===0){r=i.d.length-1,o&&i.d[r]===0&&++i.d[r];break}t=t.times(t),_r(t.d,s)}return V=!0,i}function Er(e){return e.d[e.d.length-1]&1}function Gr(e,t,r){for(var n,o=new e(t[0]),i=0;++i<t.length;)if(n=new e(t[i]),n.s)o[r](n)&&(o=n);else{o=n;break}return o}function Dt(e,t){var r,n,o,i,s,a,c,u=0,l=0,d=0,f=e.constructor,p=f.rounding,m=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(V=!1,c=m):c=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(n=Math.log(te(2,d))/Math.LN10*2+5|0,c+=n,r=i=s=new f(1),f.precision=c;;){if(i=S(i.times(e),c,1),r=r.times(++l),a=s.plus(z(i,r,c,1)),ne(a.d).slice(0,c)===ne(s.d).slice(0,c)){for(o=d;o--;)s=S(s.times(s),c,1);if(t==null)if(u<3&&Ue(s.d,c-n,p,u))f.precision=c+=10,r=i=a=new f(1),l=0,u++;else return S(s,f.precision=m,p,V=!0);else return f.precision=m,s}s=a}}function Ie(e,t){var r,n,o,i,s,a,c,u,l,d,f,p=1,m=10,y=e,b=y.d,P=y.constructor,I=P.rounding,w=P.precision;if(y.s<0||!b||!b[0]||!y.e&&b[0]==1&&b.length==1)return new P(b&&!b[0]?-1/0:y.s!=1?NaN:b?0:y);if(t==null?(V=!1,l=w):l=t,P.precision=l+=m,r=ne(b),n=r.charAt(0),Math.abs(i=y.e)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)y=y.times(e),r=ne(y.d),n=r.charAt(0),p++;i=y.e,n>1?(y=new P("0."+r),i++):y=new P(n+"."+r.slice(1))}else return u=ft(P,l+2,w).times(i+""),y=Ie(new P(n+"."+r.slice(1)),l-m).plus(u),P.precision=w,t==null?S(y,w,I,V=!0):y;for(d=y,c=s=y=z(y.minus(1),y.plus(1),l,1),f=S(y.times(y),l,1),o=3;;){if(s=S(s.times(f),l,1),u=c.plus(z(s,new P(o),l,1)),ne(u.d).slice(0,l)===ne(c.d).slice(0,l))if(c=c.times(2),i!==0&&(c=c.plus(ft(P,l+2,w).times(i+""))),c=z(c,new P(p),l,1),t==null)if(Ue(c.d,l-m,I,a))P.precision=l+=m,u=s=y=z(d.minus(1),d.plus(1),l,1),f=S(y.times(y),l,1),o=a=1;else return S(c,P.precision=w,I,V=!0);else return P.precision=w,c;c=u,o+=2}}function Hr(e){return String(e.s*e.s/0)}function Ot(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;n++);for(o=t.length;t.charCodeAt(o-1)===48;--o);if(t=t.slice(n,o),t){if(o-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%B,r<0&&(n+=B),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=B;n<o;)e.d.push(+t.slice(n,n+=B));t=t.slice(n),n=B-t.length}else n-=o;for(;n--;)t+="0";e.d.push(+t),V&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Qn(e,t){var r,n,o,i,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Wr.test(t))return Ot(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(zn.test(t))r=16,t=t.toLowerCase();else if(jn.test(t))r=2;else if(Zn.test(t))r=8;else throw Error(Se+t);for(i=t.search(/p/i),i>0?(c=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),i=t.indexOf("."),s=i>=0,n=e.constructor,s&&(t=t.replace(".",""),a=t.length,i=a-i,o=qr(n,new n(r),i,i*2)),u=ct(t,r,de),l=u.length-1,i=l;u[i]===0;--i)u.pop();return i<0?new n(e.s*0):(e.e=mt(u,l),e.d=u,V=!1,s&&(e=z(e,o,a*4)),c&&(e=e.times(Math.abs(c)<54?te(2,c):qe.pow(2,c))),V=!0,e)}function $n(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:Me(e,2,t,t);r=1.4*Math.sqrt(n),r=r>16?16:r|0,t=t.times(1/gt(5,r)),t=Me(e,2,t,t);for(var o,i=new e(5),s=new e(16),a=new e(20);r--;)o=t.times(t),t=t.times(i.plus(o.times(s.times(o).minus(a))));return t}function Me(e,t,r,n,o){var i,s,a,c,u=1,l=e.precision,d=Math.ceil(l/B);for(V=!1,c=r.times(r),a=new e(n);;){if(s=z(a.times(c),new e(t++*t++),l,1),a=o?n.plus(s):n.minus(s),n=z(s.times(c),new e(t++*t++),l,1),s=a.plus(n),s.d[d]!==void 0){for(i=d;s.d[i]===a.d[i]&&i--;);if(i==-1)break}i=a,a=n,n=s,s=i,u++}return V=!0,s.d.length=d+1,s}function gt(e,t){for(var r=e;--t;)r*=e;return r}function jr(e,t){var r,n=t.s<0,o=le(e,e.precision,1),i=o.times(.5);if(t=t.abs(),t.lte(i))return ye=n?4:1,t;if(r=t.divToInt(o),r.isZero())ye=n?3:2;else{if(t=t.minus(r.times(o)),t.lte(i))return ye=Er(r)?n?2:3:n?4:1,t;ye=Er(r)?n?1:4:n?3:2}return t.minus(o).abs()}function Wt(e,t,r,n){var o,i,s,a,c,u,l,d,f,p=e.constructor,m=r!==void 0;if(m?(ae(r,1,Le),n===void 0?n=p.rounding:ae(n,0,8)):(r=p.precision,n=p.rounding),!e.isFinite())l=Hr(e);else{for(l=pe(e),s=l.indexOf("."),m?(o=2,t==16?r=r*4-3:t==8&&(r=r*3-2)):o=t,s>=0&&(l=l.replace(".",""),f=new p(1),f.e=l.length-s,f.d=ct(pe(f),10,o),f.e=f.d.length),d=ct(l,10,o),i=c=d.length;d[--c]==0;)d.pop();if(!d[0])l=m?"0p+0":"0";else{if(s<0?i--:(e=new p(e),e.d=d,e.e=i,e=z(e,f,r,n,0,o),d=e.d,i=e.e,u=Nr),s=d[r],a=o/2,u=u||d[r+1]!==void 0,u=n<4?(s!==void 0||u)&&(n===0||n===(e.s<0?3:2)):s>a||s===a&&(n===4||u||n===6&&d[r-1]&1||n===(e.s<0?8:7)),d.length=r,u)for(;++d[--r]>o-1;)d[r]=0,r||(++i,d.unshift(1));for(c=d.length;!d[c-1];--c);for(s=0,l="";s<c;s++)l+=Mt.charAt(d[s]);if(m){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(d=ct(l,o,t),c=d.length;!d[c-1];--c);for(s=1,l="1.";s<c;s++)l+=Mt.charAt(d[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)l="0"+l;l="0."+l}else if(++i>c)for(i-=c;i--;)l+="0";else i<c&&(l=l.slice(0,i)+"."+l.slice(i))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function _r(e,t){if(e.length>t)return e.length=t,!0}function eo(e){return new this(e).abs()}function to(e){return new this(e).acos()}function ro(e){return new this(e).acosh()}function no(e,t){return new this(e).plus(t)}function oo(e){return new this(e).asin()}function io(e){return new this(e).asinh()}function so(e){return new this(e).atan()}function ao(e){return new this(e).atanh()}function uo(e,t){e=new this(e),t=new this(t);var r,n=this.precision,o=this.rounding,i=n+4;return!e.s||!t.s?r=new this(NaN):!e.d&&!t.d?(r=le(this,i,1).times(t.s>0?.25:.75),r.s=e.s):!t.d||e.isZero()?(r=t.s<0?le(this,n,o):new this(0),r.s=e.s):!e.d||t.isZero()?(r=le(this,i,1).times(.5),r.s=e.s):t.s<0?(this.precision=i,this.rounding=1,r=this.atan(z(e,t,i,1)),t=le(this,i,1),this.precision=n,this.rounding=o,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(z(e,t,i,1)),r}function co(e){return new this(e).cbrt()}function lo(e){return S(e=new this(e),e.e+1,2)}function fo(e,t,r){return new this(e).clamp(t,r)}function po(e){if(!e||typeof e!="object")throw Error(pt+"Object expected");var t,r,n,o=e.defaults===!0,i=["precision",1,Le,"rounding",0,8,"toExpNeg",-_e,0,"toExpPos",0,_e,"maxE",0,_e,"minE",-_e,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(r=i[t],o&&(this[r]=Nt[r]),(n=e[r])!==void 0)if(ie(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Se+r+": "+n);if(r="crypto",o&&(this[r]=Nt[r]),(n=e[r])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(Dr);else this[r]=!1;else throw Error(Se+r+": "+n);return this}function mo(e){return new this(e).cos()}function go(e){return new this(e).cosh()}function zr(e){var t,r,n;function o(i){var s,a,c,u=this;if(!(u instanceof o))return new o(i);if(u.constructor=o,Mr(i)){u.s=i.s,V?!i.d||i.e>o.maxE?(u.e=NaN,u.d=null):i.e<o.minE?(u.e=0,u.d=[0]):(u.e=i.e,u.d=i.d.slice()):(u.e=i.e,u.d=i.d?i.d.slice():i.d);return}if(c=typeof i,c==="number"){if(i===0){u.s=1/i<0?-1:1,u.e=0,u.d=[0];return}if(i<0?(i=-i,u.s=-1):u.s=1,i===~~i&&i<1e7){for(s=0,a=i;a>=10;a/=10)s++;V?s>o.maxE?(u.e=NaN,u.d=null):s<o.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[i]):(u.e=s,u.d=[i]);return}else if(i*0!==0){i||(u.s=NaN),u.e=NaN,u.d=null;return}return Ot(u,i.toString())}else if(c!=="string")throw Error(Se+i);return(a=i.charCodeAt(0))===45?(i=i.slice(1),u.s=-1):(a===43&&(i=i.slice(1)),u.s=1),Wr.test(i)?Ot(u,i):Qn(u,i)}if(o.prototype=h,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=po,o.clone=zr,o.isDecimal=Mr,o.abs=eo,o.acos=to,o.acosh=ro,o.add=no,o.asin=oo,o.asinh=io,o.atan=so,o.atanh=ao,o.atan2=uo,o.cbrt=co,o.ceil=lo,o.clamp=fo,o.cos=mo,o.cosh=go,o.div=yo,o.exp=ho,o.floor=bo,o.hypot=wo,o.ln=xo,o.log=To,o.log10=ko,o.log2=Po,o.max=Ao,o.min=Io,o.mod=So,o.mul=Lo,o.pow=Bo,o.random=Ro,o.round=Ko,o.sign=Co,o.sin=Vo,o.sinh=Fo,o.sqrt=Eo,o.sub=_o,o.sum=Mo,o.tan=No,o.tanh=vo,o.trunc=Do,e===void 0&&(e={}),e&&e.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function yo(e,t){return new this(e).div(t)}function ho(e){return new this(e).exp()}function bo(e){return S(e=new this(e),e.e+1,3)}function wo(){var e,t,r=new this(0);for(V=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return V=!0,new this(1/0);r=t}return V=!0,r.sqrt()}function Mr(e){return e instanceof qe||e&&e.toStringTag===Or||!1}function xo(e){return new this(e).ln()}function To(e,t){return new this(e).log(t)}function Po(e){return new this(e).log(2)}function ko(e){return new this(e).log(10)}function Ao(){return Gr(this,arguments,"lt")}function Io(){return Gr(this,arguments,"gt")}function So(e,t){return new this(e).mod(t)}function Lo(e,t){return new this(e).mul(t)}function Bo(e,t){return new this(e).pow(t)}function Ro(e){var t,r,n,o,i=0,s=new this(1),a=[];if(e===void 0?e=this.precision:ae(e,1,Le),n=Math.ceil(e/B),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));i<n;)o=t[i],o>=429e7?t[i]=crypto.getRandomValues(new Uint32Array(1))[0]:a[i++]=o%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=4);i<n;)o=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((t[i+3]&127)<<24),o>=214e7?crypto.randomBytes(4).copy(t,i):(a.push(o%1e7),i+=4);i=n/4}else throw Error(Dr);else for(;i<n;)a[i++]=Math.random()*1e7|0;for(n=a[--i],e%=B,n&&e&&(o=te(10,B-e),a[i]=(n/o|0)*o);a[i]===0;i--)a.pop();if(i<0)r=0,a=[0];else{for(r=-1;a[0]===0;r-=B)a.shift();for(n=1,o=a[0];o>=10;o/=10)n++;n<B&&(r-=B-n)}return s.e=r,s.d=a,s}function Ko(e){return S(e=new this(e),e.e+1,this.rounding)}function Co(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Vo(e){return new this(e).sin()}function Fo(e){return new this(e).sinh()}function Eo(e){return new this(e).sqrt()}function _o(e,t){return new this(e).sub(t)}function Mo(){var e=0,t=arguments,r=new this(t[e]);for(V=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return V=!0,S(r,this.precision,this.rounding)}function No(e){return new this(e).tan()}function vo(e){return new this(e).tanh()}function Do(e){return S(e=new this(e),e.e+1,1)}h[Symbol.for("nodejs.util.inspect.custom")]=h.toString;h[Symbol.toStringTag]="Decimal";var qe=h.constructor=zr(Nt);lt=new qe(lt);dt=new qe(dt);var Ut=qe;import zo from"big.js";import bt from"bn.js";import Oo from"toformat";var Wo=Oo,Ge=Wo;import ht from"big.js";import qo from"bn.js";import Go from"decimal.js-light";import He from"bn.js";var Zr=9007199254740991;function N(e){let t=Q("CobaltX_parseBigNumberish");if(e instanceof He)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new He(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Zr||e<=-Zr)&&t.logWithError(`BigNumberish number overflow: ${e}`),new He(String(e))):typeof e=="bigint"?new He(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new He(0))}var yt=Q("module/fraction"),qt=Ge(ht),je=Ge(Go),Ho={[0]:je.ROUND_DOWN,[1]:je.ROUND_HALF_UP,[2]:je.ROUND_UP},jo={[0]:ht.roundDown,[1]:ht.roundHalfUp,[2]:ht.roundUp},G=class{constructor(t,r=new qo(1)){this.numerator=N(t),this.denominator=N(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new G(this.denominator,this.numerator)}add(t){let r=t instanceof G?t:new G(N(t));return this.denominator.eq(r.denominator)?new G(this.numerator.add(r.numerator),this.denominator):new G(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(t){let r=t instanceof G?t:new G(N(t));return this.denominator.eq(r.denominator)?new G(this.numerator.sub(r.numerator),this.denominator):new G(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(t){let r=t instanceof G?t:new G(N(t));return new G(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(t){let r=t instanceof G?t:new G(N(t));return new G(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(t,r={groupSeparator:""},n=1){Number.isInteger(t)||yt.logWithError(`${t} is not an integer.`),t<=0&&yt.logWithError(`${t} is not positive.`),je.set({precision:t+1,rounding:Ho[n]});let o=new je(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),r)}toFixed(t,r={groupSeparator:""},n=1){return Number.isInteger(t)||yt.logWithError(`${t} is not an integer.`),t<0&&yt.logWithError(`${t} is negative.`),qt.DP=t,qt.RM=jo[n]||1,new qt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,r)}isZero(){return this.numerator.isZero()}};var Zo=Q("CobaltX_amount"),Xr=Ge(zo);function Xo(e,t){let r="0",n="0";if(e.includes(".")){let o=e.split(".");o.length===2?([r,n]=o,n=n.padEnd(t,"0")):Zo.logWithError(`invalid number string, num: ${e}`)}else r=e;return[r,n.slice(0,t)||n]}var he=class extends G{constructor(r,n,o=!0,i){let s=new bt(0),a=Gt.pow(new bt(r.decimals));if(o)s=N(n);else{let c=new bt(0),u=new bt(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[l,d]=Xo(n.toString(),r.decimals);c=N(l),u=N(d)}c=c.mul(a),s=c.add(u)}super(s,a);this.logger=Q(i||"TokenAmount"),this.token=r}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(r){return this.token.equals(r.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(r.raw)}lt(r){return this.token.equals(r.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(r.raw)}add(r){return this.token.equals(r.token)||this.logger.logWithError("add token not equals"),new he(this.token,this.raw.add(r.raw))}subtract(r){return this.token.equals(r.token)||this.logger.logWithError("sub token not equals"),new he(this.token,this.raw.sub(r.raw))}toSignificant(r=this.token.decimals,n,o=0){return super.toSignificant(r,n,o)}toFixed(r=this.token.decimals,n,o=0){return r>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(r,n,o)}toExact(r={groupSeparator:""}){return Xr.DP=this.token.decimals,new Xr(this.numerator.toString()).div(this.denominator.toString()).toFormat(r)}};import{TOKEN_PROGRAM_ID as Jr}from"@solana/spl-token";import{PublicKey as Jo}from"@solana/web3.js";var Yr={chainId:101,address:Jo.default.toBase58(),programId:Jr.toBase58(),decimals:9,symbol:"ETH",name:"Ethereum",logoURI:"https://raw.githubusercontent.com/cobaltx-io/tokens/main/logo/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"cobaltx",extensions:{coingeckoId:"solana"}},se={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Jr.toBase58(),decimals:9,symbol:"WETH",name:"Wrapped ETH",logoURI:"https://raw.githubusercontent.com/cobaltx-io/tokens/main/logo/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"cobaltx",extensions:{coingeckoId:"solana"}};import{PublicKey as Zt}from"@solana/web3.js";import{PublicKey as oe,SystemProgram as Qr,SYSVAR_RENT_PUBKEY as Yo}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Qo}from"@solana/spl-token";function g({pubkey:e,isSigner:t=!1,isWritable:r=!0}){return{pubkey:e,isWritable:r,isSigner:t}}var Ht=[g({pubkey:Qo,isWritable:!1}),g({pubkey:Qr.programId,isWritable:!1}),g({pubkey:Yo,isWritable:!1})];function jt({publicKey:e,transformSol:t}){let r=zt(e.toString());if(r instanceof oe)return t&&r.equals(re)?ge:r;if(t&&r.toString()===re.toBase58())return ge;if(typeof r=="string"){if(r===oe.default.toBase58())return oe.default;try{return new oe(r)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function zt(e){try{return new oe(e)}catch{return e}}var ea=new oe("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ta=new oe("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),$o=new oe("SysvarRent111111111111111111111111111111111"),ra=new oe("SysvarC1ock11111111111111111111111111111111"),na=new oe("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),ei=new oe("Sysvar1nstructions1111111111111111111111111"),oa=Qr.programId,ia=new oe("a2Gt18uJC8puJT9JRYQLU6rPi6okxQb4WqCjwtYshZB"),sa=new oe("bXSKiFqYrALF9gJy1KqHm8tv4QXk8nCgbLN8WRsGEbh"),ge=new oe("So11111111111111111111111111111111111111112"),re=oe.default,aa=new oe("71kRXzJMvSeArtXYNEWa8KAjpRJosdMQ7Dpgy5Jt5zfd"),ua=new oe("ERFzpDteGNo8LTDKW1WwVGrkRMmA2y9WZHXNHxMA6BSV");function ut(e){return jt({publicKey:e,transformSol:!0})}var Xt=class{constructor({mint:t,decimals:r,symbol:n,name:o,skipMint:i=!1,isToken2022:s=!1}){if(t===re.toBase58()||t instanceof Zt&&re.equals(t)){this.decimals=se.decimals,this.symbol=se.symbol,this.name=se.name,this.mint=new Zt(se.address),this.isToken2022=!1;return}this.decimals=r,this.symbol=n||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=i?Zt.default:jt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},Ce=Xt;Ce.WSOL=new Xt(ee(X({},se),{mint:se.address}));var Jt=class{constructor({decimals:t,symbol:r="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=r,this.name=n}equals(t){return this===t}},wt=Jt;wt.SOL=new Jt(Yr);import ti from"bn.js";var $r=new G(new ti(100)),Ne=class extends G{toSignificant(t=5,r,n){return this.mul($r).toSignificant(t,r,n)}toFixed(t=2,r,n){return this.mul($r).toFixed(t,r,n)}};var ri=Q("CobaltX_price"),be=class extends G{constructor(r){let{baseToken:n,quoteToken:o,numerator:i,denominator:s}=r;super(i,s);this.baseToken=n,this.quoteToken=o,this.scalar=new G(Yt(n.decimals),Yt(o.decimals))}get raw(){return new G(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new be({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(r){this.quoteToken!==r.baseToken&&ri.logWithError("mul token not equals");let n=super.mul(r);return new be({baseToken:this.baseToken,quoteToken:r.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(r=this.quoteToken.decimals,n,o){return this.adjusted.toSignificant(r,n,o)}toFixed(r=this.quoteToken.decimals,n,o){return this.adjusted.toFixed(r,n,o)}};import{PublicKey as ni}from"@solana/web3.js";import oi from"bn.js";function en(e){return typeof e=="object"&&e!==null&&![Ce,he,ni,G,oi,be,Ne].some(t=>typeof t=="object"&&e instanceof t)}function we(e){return typeof e=="string"?zt(e):Array.isArray(e)?e.map(t=>we(t)):en(e)?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,we(r)])):e}var Qt=new xe(0),nu=new xe(1),ou=new xe(2),iu=new xe(3),su=new xe(5),Gt=new xe(10),au=new xe(100),uu=new xe(1e3),cu=new xe(1e4);function Yt(e){return Gt.pow(N(e))}function _t(e,t=1,r=[]){let n=[...e];if(t<=0)return r;for(;n.length;)r.push(n.splice(0,t));return r}import{PublicKey as di}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as fi}from"@solana/spl-token";import{ComputeBudgetProgram as tn,Keypair as nn,PublicKey as ii,Transaction as on,TransactionMessage as si,VersionedTransaction as sn}from"@solana/web3.js";var Z={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee"};import{TOKEN_PROGRAM_ID as ai}from"@solana/spl-token";var rn=Q("CobaltX_txUtil"),an=1644;function xt(e){let t=[],r=[];return e.microLamports&&(t.push(tn.setComputeUnitPrice({microLamports:e.microLamports})),r.push(Z.SetComputeUnitPrice)),e.units&&(t.push(tn.setComputeUnitLimit({units:e.units})),r.push(Z.SetComputeUnitLimit)),{instructions:t,instructionTypes:r}}async function ve(e,t){var n,o;let r=t!=null?t:"confirmed";return(o=await((n=e.getLatestBlockhash)==null?void 0:n.call(e,{commitment:r})))==null?void 0:o.blockhash}async function Tt(e,t){return e.getSignatureStatuses([t]),new Promise((r,n)=>{let o=setTimeout(n,6e4);e.onSignature(t,i=>{if(clearTimeout(o),!i.err){r("");return}n(i.err.toString())},"confirmed")})}function ui(e,t){e.length<1&&rn.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&rn.logWithError(`no signers provided:, ${t.toString()}`);let r=new on;r.recentBlockhash="11111111111111111111111111111111",r.feePayer=t[0],r.add(...e);try{return Buffer.from(r.serialize({verifySignatures:!1})).toString("base64").length<an}catch{return!1}}function Ve(e,t){let[r,n]=ii.findProgramAddressSync(e,t);return{publicKey:r,nonce:n}}function ze({instructions:e,payer:t,signers:r}){return ui(e,[t,...r])}function Ze({instructions:e,payer:t,lookupTableAddressAccount:r,recentBlockhash:n=nn.generate().publicKey.toString()}){let i=new si({payerKey:t,recentBlockhash:n,instructions:e}).compileToV0Message(Object.values(r!=null?r:{}));try{return Buffer.from(new sn(i).serialize()).toString("base64").length<an}catch{return!1}}var ci=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e),li=e=>{let t=e.serialize({requireAllSignatures:!1,verifySignatures:!1});e instanceof sn&&(t=ci(t));try{return t instanceof Buffer?t.toString("base64"):Buffer.from(t).toString("base64")}catch{return t.toString("base64")}};function Fe(e){let t=[];return e.forEach(r=>{r instanceof on&&(r.recentBlockhash||(r.recentBlockhash=ai.toBase58()),r.feePayer||(r.feePayer=nn.generate().publicKey)),t.push(li(r))}),console.log("simulate tx string:",t),t}function De(e,t,r){return Ve([e.toBuffer(),(r!=null?r:fi).toBuffer(),t.toBuffer()],new di("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import{PublicKey as _}from"@solana/web3.js";var un=new _("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),cn=new _("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ln=new _("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Xe=new _("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ku=new _("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Cu=new _("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Vu=new _("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Fu=new _("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Eu=new _("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),_u=new _("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Mu=new _("2TnjBuwqyBB9to5jURagDT7jLmBPefGRiKL2yh1zPZ4V"),Nu=new _("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),vu=new _("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Du=new _("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ou=new _("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Wu=new _("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Uu=new _("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),qu=new _("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Gu=new _("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Hu=new _("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),ju=new _("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),zu=new _("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),pi=new _("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),mi=new _("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),gi=new _("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),Zu=new _("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),yi=new _("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),Xu=new _("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),hi=new _("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix");var Ju={SERUM_MARKET:_.default,OPENBOOK_MARKET:new _("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:_.default,FarmV3:new _("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new _("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new _("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new _("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new _("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new _("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new _("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new _("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),Router:new _("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:pi,CREATE_CPMM_POOL_AUTH:mi,CREATE_CPMM_POOL_FEE_ACC:gi,FEE_DESTINATION_ID:new _("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR"),LOCK_CPMM_PROGRAM:yi,LCOK_CPMM_AUTH:hi};import $u from"bn.js";import{PublicKey as dn,AddressLookupTableAccount as Pt}from"@solana/web3.js";async function $t({connection:e,address:t}){let r=await Fr(e,[...new Set(t.map(o=>o.toString()))].map(o=>new dn(o))),n={};for(let o=0;o<t.length;o++){let i=r[o],s=t[o];if(!i)continue;let a=new Pt({key:s,state:Pt.deserialize(i.data)});n[s.toString()]=a,kt[s.toString()]=a}return n}var kt={AiAibtFJts8e4W1FjWYRH34aBJkJqghdmXiJozK7MvTM:new Pt({key:new dn("AiAibtFJts8e4W1FjWYRH34aBJkJqghdmXiJozK7MvTM"),state:Pt.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};import{PublicKey as Je,sendAndConfirmTransaction as er,Transaction as Ye,TransactionMessage as Qe,VersionedTransaction as $e}from"@solana/web3.js";import wi from"axios";var At=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster,this.blockhashCommitment=t.blockhashCommitment,this.api=t.api}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let t=(await wi.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:r}=(n=t==null?void 0:t[15])!=null?n:{};if(!!r)return{units:6e5,microLamports:Math.min(Math.ceil(r*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:r,instructionTypes:n}=xt(t);return this.instructions.unshift(...r),this.instructionTypes.unshift(...n),!0}return!1}async calComputeBudget({config:t,defaultIns:r}){try{let n=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;r&&this.instructions.unshift(...r)}catch{r&&this.instructions.unshift(...r)}}addInstruction({instructions:t=[],endInstructions:r=[],signers:n=[],instructionTypes:o=[],endInstructionTypes:i=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...r),this.signers.push(...n),this.instructionTypes.push(...o),this.endInstructionTypes.push(...i),this.lookupTableAddress.push(...s.filter(a=>a!==Je.default.toString())),this}async versionBuild({txVersion:t,extInfo:r}){return t===0?await this.buildV0(X({},r||{})):this.build(r)}build(t){var n;let r=new Ye;return this.allInstructions.length&&r.add(...this.allInstructions),r.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(o=>o.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:r,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async o=>{var u;let{recentBlockHash:i,skipPreflight:s=!0,sendAndConfirm:a}=o||{},c=i!=null?i:await ve(this.connection,this.blockhashCommitment);if(r.recentBlockhash=c,this.signers.length&&r.sign(...this.signers),Fe([r]),(u=this.owner)!=null&&u.isKeyPair)return{txId:a?await er(this.connection,r,this.signers.find(d=>d.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(r.serialize(),{skipPreflight:s}),signedTx:r};if(this.signAllTransactions){let l=await this.signAllTransactions([r]);return{txId:await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:s}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){var u;let{extraPreBuildData:r=[],extInfo:n}=t,{transaction:o}=this.build(n),i=r.filter(l=>l.transaction.instructions.length>0),s=[o,...i.map(l=>l.transaction)],a=[this.signers,...i.map(l=>l.signers)],c=[...this.instructionTypes,...i.map(l=>l.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(l=>{l.some(d=>d.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async l=>{var P;let{sequentially:d,onTxUpdate:f,skipTxCount:p=0,recentBlockHash:m,skipPreflight:y=!0}=l||{},b=m!=null?m:await ve(this.connection,this.blockhashCommitment);if((P=this.owner)!=null&&P.isKeyPair){if(d){let I=[],w=0;for(let T of s){if(++w,w<=p)continue;let A=await er(this.connection,T,this.signers.find(k=>k.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:y});I.push(A)}return{txIds:I,signedTxs:s}}return{txIds:await await Promise.all(s.map(async I=>(I.recentBlockhash=b,await this.connection.sendRawTransaction(I.serialize(),{skipPreflight:y})))),signedTxs:s}}if(this.signAllTransactions){let I=s.map((T,A)=>(T.recentBlockhash=b,a[A].length&&T.sign(...a[A]),T));Fe(I);let w=await this.signAllTransactions(I);if(d){let T=0,A=[],k=async()=>{if(!w[T])return;let C=await this.connection.sendRawTransaction(w[T].serialize(),{skipPreflight:y});A.push({txId:C,status:"sent",signedTx:w[T]}),f==null||f([...A]),T++,this.connection.onSignature(C,R=>{let L=A.findIndex(U=>U.txId===C);L>-1&&(A[L].status=R.err?"error":"success"),f==null||f([...A]),R.err||k()},"processed"),this.connection.getSignatureStatus(C)};return await k(),{txIds:A.map(C=>C.txId),signedTxs:w}}else{let T=[];for(let A=0;A<w.length;A+=1){let k=await this.connection.sendRawTransaction(w[A].serialize(),{skipPreflight:y});T.push(k)}return{txIds:T,signedTxs:w}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:r,extInfo:n}){return r===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:n})}async buildV0(t){var y;let m=t||{},{lookupTableCache:r={},lookupTableAddress:n=[],forerunCreate:o,recentBlockhash:i}=m,s=at(m,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=X(X({},this.cluster==="devnet"?{}:kt),r),c=Array.from(new Set([...n,...this.lookupTableAddress])),u=[];for(let b of c)a[b]===void 0&&u.push(new Je(b));let l=await $t({connection:this.connection,address:u});for(let[b,P]of Object.entries(l))a[b]=P;let d=o?Je.default.toBase58():i!=null?i:await ve(this.connection,this.blockhashCommitment),f=new Qe({payerKey:this.feePayer,recentBlockhash:d,instructions:[...this.allInstructions]}).compileToV0Message();((y=this.owner)==null?void 0:y.signer)&&!this.signers.some(b=>b.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let p=new $e(f);return p.sign(this.signers),{builder:this,transaction:p,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async b=>{var w;let{skipPreflight:P=!0,sendAndConfirm:I}=b||{};if(Fe([p]),(w=this.owner)!=null&&w.isKeyPair){let T=await this.connection.sendTransaction(p,{skipPreflight:P});return I&&await Tt(this.connection,T),{txId:T,signedTx:p}}if(this.signAllTransactions){let T=await this.signAllTransactions([p]);return{txId:await this.connection.sendTransaction(T[0],{skipPreflight:P}),signedTx:T[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(t){var u;let{extraPreBuildData:r=[],buildProps:n}=t,{transaction:o}=await this.buildV0(n),i=r.filter(l=>l.builder.instructions.length>0),s=[o,...i.map(l=>l.transaction)],a=[this.signers,...i.map(l=>l.signers)],c=[...this.instructionTypes,...i.map(l=>l.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(l=>{l.some(d=>d.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(l,d)=>{l.sign(a[d])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:n,execute:async l=>{var y;let{sequentially:d,onTxUpdate:f,recentBlockHash:p,skipPreflight:m=!0}=l||{};if(p&&s.forEach(b=>b.message.recentBlockhash=p),Fe(s),(y=this.owner)!=null&&y.isKeyPair){if(d){let b=[];for(let P of s){let I=await this.connection.sendTransaction(P,{skipPreflight:m});await Tt(this.connection,I),b.push(I)}return{txIds:b,signedTxs:s}}return{txIds:await Promise.all(s.map(async b=>await this.connection.sendTransaction(b,{skipPreflight:m}))),signedTxs:s}}if(this.signAllTransactions){let b=await this.signAllTransactions(s);if(d){let P=0,I=[],w=async()=>{if(!b[P])return;let T=await this.connection.sendTransaction(b[P],{skipPreflight:m});I.push({txId:T,status:"sent",signedTx:b[P]}),f==null||f([...I]),P++,this.connection.onSignature(T,A=>{let k=I.findIndex(C=>C.txId===T);k>-1&&(I[k].status=A.err?"error":"success"),f==null||f([...I]),A.err||w()},"processed"),this.connection.getSignatureStatus(T)};return w(),{txIds:[],signedTxs:b}}else{let P=[];for(let I=0;I<b.length;I+=1){let w=await this.connection.sendTransaction(b[I],{skipPreflight:m});P.push(w)}return{txIds:P,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(t){var f;let d=t||{},{splitIns:r=[],computeBudgetConfig:n}=d,o=at(d,["splitIns","computeBudgetConfig"]),i=n?xt(n):{instructions:[],instructionTypes:[]},s=this.signers.reduce((p,m)=>ee(X({},p),{[m.publicKey.toBase58()]:m}),{}),a=[],c=[],u=[],l=0;if(this.allInstructions.forEach(p=>{let m=[...u,p],y=n?[...i.instructions,...m]:m,P=[...new Set(m.map(I=>I.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat()).values()].map(I=>new Je(I));if(p!==r[l]&&u.length<12&&(ze({instructions:y,payer:this.feePayer,signers:P})||ze({instructions:m,payer:this.feePayer,signers:P})))u.push(p);else{if(u.length===0)throw Error("item ins too big");l+=p===r[l]?1:0,ze({instructions:n?[...i.instructions,...u]:[...u],payer:this.feePayer,signers:P})?a.push(new Ye().add(...i.instructions,...u)):a.push(new Ye().add(...u)),c.push(Array.from(new Set(u.map(I=>I.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat())).map(I=>s[I]).filter(I=>I!==void 0)),u=[p]}}),u.length>0){let m=[...new Set(u.map(y=>y.keys.filter(b=>b.isSigner).map(b=>b.pubkey.toString())).flat()).values()].map(y=>s[y]).filter(y=>y!==void 0);ze({instructions:n?[...i.instructions,...u]:[...u],payer:this.feePayer,signers:m.map(y=>y.publicKey)})?a.push(new Ye().add(...i.instructions,...u)):a.push(new Ye().add(...u)),c.push(m)}return a.forEach(p=>p.feePayer=this.feePayer),(f=this.owner)!=null&&f.signer&&c.forEach(p=>{p.some(m=>m.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),{builder:this,transactions:a,signers:c,instructionTypes:this.instructionTypes,execute:async p=>{var T;let{sequentially:m,onTxUpdate:y,skipTxCount:b=0,recentBlockHash:P,skipPreflight:I=!0}=p||{},w=P!=null?P:await ve(this.connection,this.blockhashCommitment);if(a.forEach(async(A,k)=>{A.recentBlockhash=w,c[k].length&&A.sign(...c[k])}),Fe(a),(T=this.owner)!=null&&T.isKeyPair){if(m){let A=0,k=[];for(let C of a){if(++A,A<=b){k.push("tx skipped");continue}let R=await er(this.connection,C,this.signers.find(L=>L.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:I});k.push(R)}return{txIds:k,signedTxs:a}}return{txIds:await Promise.all(a.map(async A=>await this.connection.sendRawTransaction(A.serialize(),{skipPreflight:I}))),signedTxs:a}}if(this.signAllTransactions){let A=await this.signAllTransactions(a.slice(b,a.length)),k=[...a.slice(0,b),...A];if(m){let C=0,R=[],L=async()=>{if(!k[C])return;C<b&&(R.push({txId:"",status:"success",signedTx:k[C]}),y==null||y([...R]),C++,L());let U=await this.connection.sendRawTransaction(k[C].serialize(),{skipPreflight:I});R.push({txId:U,status:"sent",signedTx:k[C]}),y==null||y([...R]),C++,this.connection.onSignature(U,O=>{let M=R.findIndex(K=>K.txId===U);M>-1&&(R[M].status=O.err?"error":"success"),y==null||y([...R]),O.err||L()},"processed"),this.connection.getSignatureStatus(U)};return await L(),{txIds:R.map(U=>U.txId),signedTxs:k}}else{let C=[];for(let R=0;R<k.length;R+=1){let L=await this.connection.sendRawTransaction(k[R].serialize(),{skipPreflight:I});C.push(L)}return{txIds:C,signedTxs:k}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async sizeCheckBuildV0(t){var w;let I=t||{},{computeBudgetConfig:r,splitIns:n=[],lookupTableCache:o={},lookupTableAddress:i=[]}=I,s=at(I,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=X(X({},this.cluster==="devnet"?{}:kt),o),c=Array.from(new Set([...this.lookupTableAddress,...i])),u=[];for(let T of c)a[T]===void 0&&u.push(new Je(T));let l=await $t({connection:this.connection,address:u});for(let[T,A]of Object.entries(l))a[T]=A;let d=r?xt(r):{instructions:[],instructionTypes:[]},f=await ve(this.connection,this.blockhashCommitment),p=this.signers.reduce((T,A)=>ee(X({},T),{[A.publicKey.toBase58()]:A}),{}),m=[],y=[],b=[],P=0;if(this.allInstructions.forEach(T=>{let A=[...b,T],k=r?[...d.instructions,...A]:A;if(T!==n[P]&&b.length<12&&(Ze({instructions:k,payer:this.feePayer,lookupTableAddressAccount:a})||Ze({instructions:A,payer:this.feePayer,lookupTableAddressAccount:a})))b.push(T);else{if(b.length===0)throw Error("item ins too big");P+=T===n[P]?1:0;let C={};for(let R of[...new Set(c)])a[R]!==void 0&&(C[R]=a[R]);if(r&&Ze({instructions:[...d.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:f})){let R=new Qe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...d.instructions,...b]}).compileToV0Message(Object.values(a));m.push(new $e(R))}else{let R=new Qe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...b]}).compileToV0Message(Object.values(a));m.push(new $e(R))}y.push(Array.from(new Set(b.map(R=>R.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat())).map(R=>p[R]).filter(R=>R!==void 0)),b=[T]}}),b.length>0){let A=[...new Set(b.map(k=>k.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat()).values()].map(k=>p[k]).filter(k=>k!==void 0);if(r&&Ze({instructions:[...d.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:f})){let k=new Qe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...d.instructions,...b]}).compileToV0Message(Object.values(a));m.push(new $e(k))}else{let k=new Qe({payerKey:this.feePayer,recentBlockhash:f,instructions:[...b]}).compileToV0Message(Object.values(a));m.push(new $e(k))}y.push(A)}return(w=this.owner)!=null&&w.signer&&y.forEach(T=>{T.some(A=>A.publicKey.equals(this.owner.publicKey))||T.push(this.owner.signer)}),{builder:this,transactions:m,buildProps:t,signers:y,instructionTypes:this.instructionTypes,execute:async T=>{var U;let{sequentially:A,onTxUpdate:k,skipTxCount:C=0,recentBlockHash:R,skipPreflight:L=!0}=T||{};if(m.map(async(O,M)=>{y[M].length&&O.sign(y[M]),R&&(O.message.recentBlockhash=R)}),Fe(m),(U=this.owner)!=null&&U.isKeyPair){if(A){let O=0,M=[];for(let K of m){if(++O,O<=C){console.log("skip tx: ",O),M.push("tx skipped");continue}let q=await this.connection.sendTransaction(K,{skipPreflight:L});await Tt(this.connection,q),M.push(q)}return{txIds:M,signedTxs:m}}return{txIds:await Promise.all(m.map(async O=>await this.connection.sendTransaction(O,{skipPreflight:L}))),signedTxs:m}}if(this.signAllTransactions){let O=await this.signAllTransactions(m.slice(C,m.length)),M=[...m.slice(0,C),...O];if(A){let K=0,q=[],H=async()=>{if(!M[K])return;if(K<C){q.push({txId:"",status:"success",signedTx:M[K]}),k==null||k([...q]),K++,H();return}let W=await this.connection.sendTransaction(M[K],{skipPreflight:L});q.push({txId:W,status:"sent",signedTx:M[K]}),k==null||k([...q]),K++,this.connection.onSignature(W,We=>{let Lr=q.findIndex(Dn=>Dn.txId===W);Lr>-1&&(q[Lr].status=We.err?"error":"success"),k==null||k([...q]),We.err||H()},"processed"),this.connection.getSignatureStatus(W)};return H(),{txIds:[],signedTxs:M}}else{let K=[];for(let q=0;q<M.length;q+=1){let H=await this.connection.sendTransaction(M[q],{skipPreflight:L});K.push(H)}return{txIds:K,signedTxs:M}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};import{createAssociatedTokenAccountInstruction as ss}from"@solana/spl-token";import{PublicKey as j,SystemProgram as as}from"@solana/web3.js";function xi(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function tr(e,...t){if(!xi(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function rr(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function fn(e,t){tr(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var St=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),fe=(e,t)=>e<<32-t|e>>>t;var Mc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ti(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function nr(e){return typeof e=="string"&&(e=Ti(e)),tr(e),e}var It=class{clone(){return this._cloneInto()}},Nc={}.toString;function pn(e){let t=n=>e().update(nr(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Pi(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),a=Number(r&i),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)}var mn=(e,t,r)=>e&t^~e&r,gn=(e,t,r)=>e&t^e&r^t&r,Lt=class extends It{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=St(this.buffer)}update(t){rr(this);let{view:r,buffer:n,blockLen:o}=this;t=nr(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(o-this.pos,i-s);if(a===o){let c=St(t);for(;o<=i-s;s+=o)this.process(c,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){rr(this),fn(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(n,0),s=0);for(let d=s;d<o;d++)r[d]=0;Pi(n,o-8,BigInt(this.length*8),i),this.process(n,0);let a=St(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%r&&t.buffer.set(n),t}};var ki=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Be=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Re=new Uint32Array(64),or=class extends Lt{constructor(){super(64,32,8,!1),this.A=Be[0]|0,this.B=Be[1]|0,this.C=Be[2]|0,this.D=Be[3]|0,this.E=Be[4]|0,this.F=Be[5]|0,this.G=Be[6]|0,this.H=Be[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:s,G:a,H:c}=this;return[t,r,n,o,i,s,a,c]}set(t,r,n,o,i,s,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,r){for(let d=0;d<16;d++,r+=4)Re[d]=t.getUint32(r,!1);for(let d=16;d<64;d++){let f=Re[d-15],p=Re[d-2],m=fe(f,7)^fe(f,18)^f>>>3,y=fe(p,17)^fe(p,19)^p>>>10;Re[d]=y+Re[d-7]+m+Re[d-16]|0}let{A:n,B:o,C:i,D:s,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){let f=fe(a,6)^fe(a,11)^fe(a,25),p=l+f+mn(a,c,u)+ki[d]+Re[d]|0,y=(fe(n,2)^fe(n,13)^fe(n,22))+gn(n,o,i)|0;l=u,u=c,c=a,a=s+p|0,s=i,i=o,o=n,n=p+y|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,o,i,s,a,c,u,l)}roundClean(){Re.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var yn=pn(()=>new or);import{TOKEN_PROGRAM_ID as Fi}from"@solana/spl-token";import{Keypair as Ei,PublicKey as _i}from"@solana/web3.js";import $l from"bn.js";import{PublicKey as Ki}from"@solana/web3.js";import xn,{isBN as Tn}from"bn.js";import{bits as jc,BitStructure as zc,blob as Ai,Blob as Zc,cstr as Xc,f32 as Jc,f32be as Yc,f64 as Qc,f64be as $c,greedy as el,Layout as Ii,ns64 as tl,ns64be as rl,nu64 as nl,nu64be as ol,offset as il,s16 as sl,s16be as al,s24 as ul,s24be as cl,s32 as ll,s32be as dl,s40 as fl,s40be as pl,s48 as ml,s48be as gl,s8 as yl,seq as Si,struct as hl,Structure as Li,u16 as bl,u16be as wl,u24 as xl,u24be as Tl,u32 as Pl,u32be as kl,u40 as Al,u40be as Il,u48 as Sl,u48be as Ll,u8 as Bi,UInt as Ri,union as Bl,Union as Rl,unionLayoutDiscriminator as Kl,utf8 as Cl}from"@solana/buffer-layout";var ir=Ii,hn=Li;var sr=Ri;var bn=Bi;var wn=Si;var Ee=Ai;var Oe=class extends ir{constructor(r,n,o){super(r,o);this.blob=Ee(r),this.signed=n}decode(r,n=0){let o=new xn(this.blob.decode(r,n),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(r,n,o=0){return typeof r=="number"&&(r=new xn(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),n,o)}};function $(e){return new sr(1,e)}function et(e){return new sr(4,e)}function x(e){return new Oe(8,!1,e)}function Te(e){return new Oe(16,!1,e)}function Pn(e){return new Oe(1,!0,e)}function Rt(e){return new Oe(8,!0,e)}var Bt=class extends ir{constructor(r,n,o,i){super(r.span,i);this.layout=r,this.decoder=n,this.encoder=o}decode(r,n){return this.decoder(this.layout.decode(r,n))}encode(r,n,o){return this.layout.encode(this.encoder(r),n,o)}getSpan(r,n){return this.layout.getSpan(r,n)}};function v(e){return new Bt(Ee(32),t=>new Ki(t),t=>t.toBuffer(),e)}function Kt(e){return new Bt(bn(),Ci,Vi,e)}function Ci(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function Vi(e){return e?1:0}var ar=class extends hn{decode(t,r){return super.decode(t,r)}};function J(e,t,r){return new ar(e,t,r)}function Y(e,t,r){let n,o=typeof t=="number"?t:Tn(t)?t.toNumber():new Proxy(t,{get(i,s){if(!n){let a=Reflect.get(i,"count");n=Tn(a)?a.toNumber():a,Reflect.set(i,"count",n)}return Reflect.get(i,s)},set(i,s,a){return s==="count"&&(n=a),Reflect.set(i,s,a)}});return wn(e,o,r)}var tt=J([v("mint"),v("owner"),x("amount"),et("delegateOption"),v("delegate"),$("state"),et("isNativeOption"),x("isNative"),x("delegatedAmount"),et("closeAuthorityOption"),v("closeAuthority")]);var rd=Q("CobaltX_Util");function Ct({fromPublicKey:e,programId:t=Fi,assignSeed:r}){let n=r?btoa(r).slice(0,32):Ei.generate().publicKey.toBase58().slice(0,32);return{publicKey:Mi(e,n,t),seed:n}}function Mi(e,t,r){let n=Buffer.concat([e.toBuffer(),Buffer.from(t),r.toBuffer()]),o=yn(n);return new _i(o)}import{PublicKey as Ni,SystemProgram as vi}from"@solana/web3.js";import Di from"bn.js";import{createCloseAccountInstruction as Oi,createInitializeAccountInstruction as Wi,createTransferInstruction as pd,TOKEN_PROGRAM_ID as rt}from"@solana/spl-token";function Ui(e){let{mint:t,tokenAccount:r,owner:n,programId:o=rt}=e;return Wi(r,t,n,o)}function qi(e){let{tokenAccount:t,payer:r,multiSigners:n=[],owner:o,programId:i=rt}=e;return Oi(t,r,o,n,i)}async function ur(e){let{connection:t,amount:r,commitment:n,payer:o,owner:i,skipCloseAccount:s}=e,a=await t.getMinimumBalanceForRentExemption(tt.span,n),c=N(r).add(new Di(a)),u=Ct({fromPublicKey:o,programId:rt});return{addresses:{newAccount:u.publicKey},signers:[],instructions:[vi.createAccountWithSeed({fromPubkey:o,basePubkey:o,seed:u.seed,newAccountPubkey:u.publicKey,lamports:c.toNumber(),space:tt.span,programId:rt}),Ui({mint:new Ni(se.address),tokenAccount:u.publicKey,owner:i,programId:rt})],instructionTypes:[Z.CreateAccount,Z.InitAccount],endInstructionTypes:s?[]:[Z.CloseAccount],endInstructions:s?[]:[qi({tokenAccount:u.publicKey,payer:o,owner:i})]}}var cr=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),nt=class{constructor({scope:t,moduleName:r}){this.disabled=!1;this.scope=t,this.logger=Q(r)}createTxBuilder(t){return this.scope.checkOwner(),new At({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(cr(t))}logInfo(...t){this.logger.info(cr(t))}logAndCreateError(...t){let r=cr(t);throw new Error(r)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as In}from"@solana/web3.js";var lr=J([$("instruction")]),dr=J([$("instruction")]),Gi=J([x("rewardState"),x("rewardOpenTime"),x("rewardEndTime"),x("rewardLastUpdateTime"),x("totalReward"),x("totalRewardEmissioned"),x("rewardClaimed"),x("rewardPerSecond"),Te("accRewardPerShare"),v("rewardVault"),v("rewardMint"),v("rewardSender"),x("rewardType"),Y(x(),15,"padding")]),Hi=J([x("state"),x("nonce"),v("lpVault"),v("rewardVault"),v(),v(),x(),x(),x("totalReward"),Te("perShareReward"),x("lastSlot"),x("perSlotReward")]),ji=J([x("state"),x("nonce"),v("lpVault"),v("rewardVaultA"),x("totalRewardA"),Te("perShareRewardA"),x("perSlotRewardA"),$("option"),v("rewardVaultB"),Ee(7),x("totalRewardB"),Te("perShareRewardB"),x("perSlotRewardB"),x("lastSlot"),v()]),zi=J([x(),x("state"),x("nonce"),x("validRewardTokenNum"),Te("rewardMultiplier"),x("rewardPeriodMax"),x("rewardPeriodMin"),x("rewardPeriodExtend"),v("lpMint"),v("lpVault"),Y(Gi,5,"rewardInfos"),v("creator"),v(),Y(x(),32,"padding")]),Zi=new Proxy(Hi,{get(e,t,r){return t==="decode"?(...n)=>{let o=e.decode(...n);return ee(X({},o),{version:3,rewardInfos:[{rewardVault:o.rewardVault,totalReward:o.totalReward,perSlotReward:o.perSlotReward,perShareReward:o.perShareReward}]})}:Reflect.get(e,t,r)}}),Xi=new Proxy(ji,{get(e,t,r){return t==="decode"?(...n)=>{let o=e.decode(...n);return ee(X({},o),{version:5,rewardInfos:[{rewardVault:o.rewardVaultA,totalReward:o.totalRewardA,perSlotReward:o.perSlotRewardA,perShareReward:o.perShareRewardA},{rewardVault:o.rewardVaultB,totalReward:o.totalRewardB,perSlotReward:o.perSlotRewardB,perShareReward:o.perShareRewardB}]})}:Reflect.get(e,t,r)}}),Vt=new Proxy(zi,{get(e,t,r){return t==="decode"?(...n)=>{let o=e.decode(...n);return ee(X({},o),{version:6,rewardInfos:o.rewardInfos.map(i=>{var s;return ee(X({},i),{rewardType:((s=Object.entries(Ke).find(a=>String(a[1])===i.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(e,t,r)}}),Ji=J([x("isSet"),x("rewardPerSecond"),x("rewardOpenTime"),x("rewardEndTime"),x("rewardType")]),fr=J([$("instruction"),x("nonce"),Y(Ji,5,"rewardTimeInfo")]),pr=J([$("instruction"),x("rewardReopenTime"),x("rewardEndTime"),x("rewardPerSecond")]),mr=J([$("instruction"),x("isSet"),x("rewardPerSecond"),x("rewardOpenTime"),x("rewardEndTime"),x("rewardType")]),Bd=J([x("state"),v("id"),v("owner"),x("deposited"),Y(x(),1,"rewardDebts")]),gr=J([x("state"),v("id"),v("owner"),x("deposited"),Y(Te(),1,"rewardDebts"),x(""),x("voteLockedBalance"),Y(x(),15)]),Rd=J([x("state"),v("id"),v("owner"),x("deposited"),Y(x(),2,"rewardDebts")]),kn=J([x("state"),v("id"),v("owner"),x("deposited"),Y(Te(),2,"rewardDebts"),Y(x(),17)]),An=J([x(),x("state"),v("id"),v("owner"),x("deposited"),Y(Te(),5,"rewardDebts"),Y(x(),16)]),ue=J([$("instruction"),x("amount")]),Yi=J([v("mint"),v("grantAuthority"),x("baselineVoteWeightScaledFactor"),x("maxExtraLockupVoteWeightScaledFactor"),x("lockupSaturationSecs"),Pn("digitShift"),Y($(),7,"reserved1"),Y(x(),7,"reserved2")]),Qi=J([Ee(8),v("governanceProgramId"),v("realm"),v("realmGoverningTokenMint"),v("realmAuthority"),Y($(),32,"reserved1"),Y(Yi,4,"votingMints"),Rt("timeOffset"),$("bump"),Y($(),7,"reserved2"),Y(x(),11,"reserved3")]),$i=J([Rt("startTime"),Rt("endTime"),$("kind"),Y($(),15,"reserved")]),es=J([Y($i,1,"lockup"),x("amountDeposited_native"),x("amountInitiallyLockedNative"),Kt("isUsed"),Kt("allowClawback"),$("votingMintConfigIdx"),Y($(),29,"reserved")]),ts=J([Ee(8),v("voterAuthority"),v("registrar"),Y(es,32,"deposits"),$("voterBump"),$("voterWweightRecordBump"),Y($(),94,"reserved")]);var Nd=Q("CobaltX_farm_config"),Sn=new In("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ln=new In("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1");var Bn={3:gr,5:kn,6:An},yr=e=>[3,4,5,6].indexOf(e)!==-1,hr=e=>{var s;let{version:t,rewardInfos:r,rewardTokenAccountsPublicKeys:n}=e,o=`rewardInfo:${JSON.stringify(r)}, rewardAccount:${JSON.stringify(n)}`,i={3:()=>{if(r.length!==1||n.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${o}`},5:()=>{if(r.length!==n.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${o}`},6:()=>{if(!n.length||r.length!==n.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${o}`}};return(s=i[t])==null?void 0:s.call(i)},Ke={"Standard SPL":0,"Option tokens":1},Pe={[un.toString()]:3,[cn.toString()]:4,[ln.toString()]:5,[Xe.toString()]:6};import{ASSOCIATED_TOKEN_PROGRAM_ID as mf,createAssociatedTokenAccountInstruction as gf,TOKEN_PROGRAM_ID as ke}from"@solana/spl-token";import{PublicKey as D,SystemProgram as Cn,SYSVAR_CLOCK_PUBKEY as it,SYSVAR_RENT_PUBKEY as os,TransactionInstruction as ce}from"@solana/web3.js";import Vn from"bn.js";import rs from"bn.js";var ns=Q("CobaltX.farm.util");function ot({programId:e,poolId:t,mint:r,type:n}){let{publicKey:o}=Ve([t.toBuffer(),r.toBuffer(),Buffer.from(n==="lpVault"?"lp_vault_associated_seed":n==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return o}function me({programId:e,poolId:t,owner:r,version:n}){let{publicKey:o}=Ve([t.toBuffer(),r.toBuffer(),Buffer.from(n===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return o}var Rn=({programId:e,poolId:t})=>Ve([t.toBuffer()],e);function Kn(e){return{isSet:new rs(1),rewardPerSecond:N(e.perSecond),rewardOpenTime:N(e.openTime),rewardEndTime:N(e.endTime),rewardType:N(Ke[e.rewardType])}}function br(e){return N(e.endTime).sub(N(e.openTime)).mul(N(e.perSecond))}function wr(e){let t=Bn[e];return t||ns.logWithError("invalid version",e),t}var is=Q("CobaltX_farm_instruction"),Rf={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};function xr(e){let{version:t,id:r,ledger:n,programId:o,owner:i}=e,s={3:9,5:10}[t];s||is.logWithError(`invalid farm pool version: ${t}`);let a=Buffer.alloc(lr.span);lr.encode({instruction:s},a);let c=[g({pubkey:r}),g({pubkey:n}),g({pubkey:i,isWritable:!1}),g({pubkey:Cn.programId,isWritable:!1}),g({pubkey:os,isWritable:!1})];return{instruction:new ce({programId:o,keys:c,data:a}),instructionType:Z.FarmV3CreateLedger}}function Fn(e){var n;let t=Buffer.alloc(fr.span);fr.encode({instruction:0,nonce:new Vn(e.nonce),rewardTimeInfo:e.rewardInfoConfig},t);let r=[...Ht,g({pubkey:e.farmId}),g({pubkey:e.farmAuthority,isWritable:!1}),g({pubkey:e.lpVault}),g({pubkey:e.lpMint,isWritable:!1}),g({pubkey:e.lockVault}),g({pubkey:e.lockMint,isWritable:!1}),g({pubkey:(n=e.lockUserAccount)!=null?n:re}),g({pubkey:e.owner,isWritable:!1,isSigner:!0})];for(let o of e.rewardInfo)r.push(g({pubkey:o.rewardMint,isWritable:!1}),g({pubkey:o.rewardVault}),g({pubkey:o.userRewardToken}));return{instruction:new ce({programId:e.programId,keys:r,data:t}),instructionType:Z.FarmV6Create}}function En(e){let t=Buffer.alloc(dr.span);dr.encode({instruction:5},t);let r=[g({pubkey:ke,isWritable:!1}),g({pubkey:e.id}),g({pubkey:e.authority,isWritable:!1}),g({pubkey:e.lpVault,isWritable:!1}),g({pubkey:e.rewardVault}),g({pubkey:e.userRewardToken}),g({pubkey:e.owner,isWritable:!1,isSigner:!0})];return{instruction:new ce({programId:e.programId,keys:r,data:t}),instructionType:Z.FarmV6CreatorWithdraw}}function Tr({payer:e,rewardVault:t,userRewardTokenPub:r,farmKeys:n,rewardInfo:o}){let i=Buffer.alloc(pr.span);pr.encode({instruction:3,rewardReopenTime:N(o.openTime),rewardEndTime:N(o.endTime),rewardPerSecond:N(o.perSecond)},i);let s=[g({pubkey:ke,isWritable:!1}),g({pubkey:n.id}),g({pubkey:n.lpVault,isWritable:!1}),g({pubkey:t}),g({pubkey:r}),g({pubkey:e,isWritable:!1,isSigner:!0})];return new ce({programId:n.programId,keys:s,data:i})}function Pr({payer:e,userRewardTokenPub:t,farmKeys:r,rewardVault:n,rewardInfo:o}){let i=Buffer.alloc(mr.span);mr.encode({instruction:4,isSet:new Vn(1),rewardPerSecond:N(o.perSecond),rewardOpenTime:N(o.openTime),rewardEndTime:N(o.endTime),rewardType:N(Ke[o.rewardType])},i);let s=[...Ht,g({pubkey:r.id}),g({pubkey:r.authority,isWritable:!1}),g({pubkey:o.mint,isWritable:!1}),g({pubkey:n}),g({pubkey:t}),g({pubkey:e,isWritable:!1,isSigner:!0})];return new ce({programId:r.programId,keys:s,data:i})}function kr(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s}=e,[a,c]=[new D(t.programId),new D(t.id)],u=me({programId:a,poolId:c,owner:i,version:6}),l=Buffer.alloc(ue.span);ue.encode({instruction:2,amount:N(s)},l);let d=[g({pubkey:ke,isWritable:!1}),g({pubkey:c}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:new D(r.lpVault)}),g({pubkey:u}),g({pubkey:i,isWritable:!1,isSigner:!0}),g({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(g({pubkey:new D(r.rewardInfos[f].vault)})),d.push(g({pubkey:o[f]}));return new ce({programId:a,keys:d,data:l})}function Ar(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:5}),d=Buffer.alloc(ue.span);ue.encode({instruction:12,amount:N(s)},d);let f=[g({pubkey:u}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:l}),g({pubkey:i,isWritable:!1,isSigner:!0}),g({pubkey:n}),g({pubkey:new D(r.lpVault)}),g({pubkey:o[0]}),g({pubkey:new D(r.rewardInfos[0].vault)}),g({pubkey:it,isWritable:!1}),g({pubkey:ke,isWritable:!1})];for(let p=1;p<r.rewardInfos.length;p++)f.push(g({pubkey:o[p]})),f.push(g({pubkey:new D(r.rewardInfos[p].vault)}));if(a)for(let p of a)f.push(g({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function _n(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=J([$("instruction"),x("amount")]),d=[g({pubkey:u}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:a[0]}),g({pubkey:i,isSigner:!0,isWritable:!1}),g({pubkey:n}),g({pubkey:new D(r.lpVault)}),g({pubkey:o[0]}),g({pubkey:new D(r.rewardInfos[0].vault)}),g({pubkey:it,isWritable:!1}),g({pubkey:ke,isWritable:!1}),g({pubkey:o[1]}),g({pubkey:new D(r.rewardInfos[1].vault)})],f=Buffer.alloc(l.span);return l.encode({instruction:2,amount:s},f),new ce({keys:d,programId:c,data:f})}function Ir(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:3}),d=Buffer.alloc(ue.span);ue.encode({instruction:11,amount:N(s)},d);let f=[g({pubkey:u}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:l}),g({pubkey:i,isWritable:!1,isSigner:!0}),g({pubkey:n}),g({pubkey:new D(r.lpVault)}),g({pubkey:o[0]}),g({pubkey:new D(r.rewardInfos[0].vault)}),g({pubkey:it,isWritable:!1}),g({pubkey:ke,isWritable:!1})];if(a)for(let p of a)f.push(g({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function Mn(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:3}),d=Buffer.alloc(ue.span);ue.encode({instruction:10,amount:N(s)},d);let f=[g({pubkey:u}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:l}),g({pubkey:i,isWritable:!1,isSigner:!0}),g({pubkey:n}),g({pubkey:new D(r.lpVault)}),g({pubkey:o[0]}),g({pubkey:new D(r.rewardInfos[0].vault)}),g({pubkey:it,isWritable:!1}),g({pubkey:ke,isWritable:!1})];if(a)for(let p of a)f.push(g({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function Nn(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:5}),d=Buffer.alloc(ue.span);ue.encode({instruction:11,amount:N(s)},d);let f=[g({pubkey:u}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:l}),g({pubkey:i,isWritable:!1,isSigner:!0}),g({pubkey:n}),g({pubkey:new D(r.lpVault)}),g({pubkey:o[0]}),g({pubkey:new D(r.rewardInfos[0].vault)}),g({pubkey:it,isWritable:!1}),g({pubkey:ke,isWritable:!1})];for(let p=1;p<r.rewardInfos.length;p++)f.push(g({pubkey:o[p]})),f.push(g({pubkey:new D(r.rewardInfos[p].vault)}));if(a)for(let p of a)f.push(g({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function vn(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s}=e,[a,c]=[new D(t.programId),new D(t.id)],u=me({programId:a,poolId:c,owner:i,version:6}),l=Buffer.alloc(ue.span);ue.encode({instruction:1,amount:N(s)},l);let d=[g({pubkey:ke,isWritable:!1}),g({pubkey:Cn.programId,isWritable:!1}),g({pubkey:c}),g({pubkey:new D(r.authority),isWritable:!1}),g({pubkey:new D(r.lpVault)}),g({pubkey:u}),g({pubkey:i,isWritable:!1,isSigner:!0}),g({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(g({pubkey:new D(r.rewardInfos[f].vault)})),d.push(g({pubkey:o[f]}));return new ce({programId:a,keys:d,data:l})}var Sr=class extends nt{async _getUserRewardInfo({payer:t,rewardInfo:r}){if(r.mint.equals(re)){let n=await ur({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:t,amount:br(ee(X({},r),{openTime:r.openTime.toString(),endTime:r.endTime.toString()}))});return{rewardPubKey:n.addresses.newAccount,newInstruction:n}}return{rewardPubKey:await this.scope.account.getCreatedTokenAccount({mint:r.mint,associatedOnly:!1})}}async create({poolInfo:t,rewardInfos:r,payer:n,programId:o=Xe,txVersion:i}){this.checkDisabled(),this.scope.checkOwner();let a={lpMint:new j(t.lpMint.address),lockInfo:{lockMint:Sn,lockVault:Ln},version:6,rewardInfos:r,programId:o},c=this.createTxBuilder(),u=n!=null?n:this.scope.ownerPubKey,l=Ct({fromPublicKey:u,programId:a.programId}),d=await this.scope.connection.getMinimumBalanceForRentExemption(Vt.span);c.addInstruction({instructions:[as.createAccountWithSeed({fromPubkey:u,basePubkey:u,seed:l.seed,newAccountPubkey:l.publicKey,lamports:d,space:Vt.span,programId:a.programId})]});let{publicKey:f,nonce:p}=Rn({programId:new j(a.programId),poolId:l.publicKey}),m=ot({programId:a.programId,poolId:l.publicKey,mint:a.lpMint,type:"lpVault"}),y=[],b=[];for(let A of a.rewardInfos){A.openTime>=A.endTime&&this.logAndCreateError("start time error","rewardInfo.rewardOpenTime",A.openTime.toString()),isNaN(Ke[A.rewardType])&&this.logAndCreateError("rewardType error",A.rewardType),Number(A.perSecond)<=0&&this.logAndCreateError("rewardPerSecond error",A.perSecond),y.push(Kn(A));let{rewardPubKey:k,newInstruction:C}=await this._getUserRewardInfo({rewardInfo:A,payer:u});C&&c.addInstruction(C),k||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let R=A.mint.equals(re)?new j(se.address):A.mint;b.push({rewardMint:R,rewardVault:ot({programId:a.programId,poolId:l.publicKey,mint:R,type:"rewardVault"}),userRewardToken:k})}let{account:P,instructionParams:I}=await this.scope.account.getOrCreateTokenAccount({mint:new j(a.lockInfo.lockMint),owner:this.scope.ownerPubKey,skipCloseAccount:!1,createInfo:{payer:this.scope.ownerPubKey,amount:0},associatedOnly:!1});I&&c.addInstruction(I),P||this.logAndCreateError("cannot found lock vault","tokenAccounts",this.scope.account.tokenAccounts);let{instruction:w,instructionType:T}=Fn({farmId:l.publicKey,owner:this.scope.ownerPubKey,farmAuthority:f,lpVault:m,lpMint:a.lpMint,lockVault:a.lockInfo.lockVault,lockMint:a.lockInfo.lockMint,lockUserAccount:P,programId:a.programId,rewardInfo:b,rewardInfoConfig:y,nonce:p});return c.addInstruction({instructions:[w],instructionTypes:[T]}).versionBuild({txVersion:i,extInfo:{farmId:l.publicKey,farmAuthority:f,lpVault:m,lockUserAccount:P,nonce:p}})}async restartReward({farmInfo:t,payer:r,newRewardInfo:n,txVersion:o}){var b;let i=Pe[t.programId];i!==6&&this.logAndCreateError("invalid farm version ",i);let s=we((await this.scope.api.fetchFarmKeysById({ids:t.id}))[0]),a={id:s.id,rewardInfos:t.rewardInfos,lpVault:s.lpVault,programId:s.programId};n.openTime>=n.endTime&&this.logAndCreateError("start time error","newRewardInfo",n);let c=r||this.scope.ownerPubKey,u=n.mint.equals(re)?new j(se.address):n.mint,l=a.rewardInfos.findIndex(P=>new j(P.mint.address).equals(u)),d=s.rewardInfos[l];d||this.logAndCreateError("configuration does not exist","rewardMint",u);let f=(b=d.vault)!=null?b:re,p=this.createTxBuilder(),{rewardPubKey:m,newInstruction:y}=await this._getUserRewardInfo({rewardInfo:n,payer:c});return y&&p.addInstruction(y),m||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts),p.addInstruction({instructions:[Tr({payer:this.scope.ownerPubKey,rewardVault:f,userRewardTokenPub:m,farmKeys:a,rewardInfo:n})],instructionTypes:[Z.FarmV6Restart]}).versionBuild({txVersion:o})}async restartRewards({farmInfo:t,payer:r,newRewardInfos:n,txVersion:o}){var l;let i=Pe[t.programId];i!==6&&this.logAndCreateError("invalid farm version ",i);let s=we((await this.scope.api.fetchFarmKeysById({ids:t.id}))[0]),a={id:s.id,rewardInfos:t.rewardInfos,lpVault:s.lpVault,programId:s.programId};n.forEach(d=>{d.openTime>=d.endTime&&this.logAndCreateError("start time error","newRewardInfo",d)});let c=r||this.scope.ownerPubKey,u=this.createTxBuilder();for(let d of n){let f=d.mint.equals(re)?new j(se.address):d.mint,p=a.rewardInfos.findIndex(w=>new j(w.mint.address).equals(f)),m=s.rewardInfos[p];m||this.logAndCreateError("configuration does not exist","rewardMint",f);let y=(l=m.vault)!=null?l:re,{rewardPubKey:b,newInstruction:P}=await this._getUserRewardInfo({rewardInfo:d,payer:c});P&&u.addInstruction(P),b||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let I=Tr({payer:this.scope.ownerPubKey,rewardVault:y,userRewardTokenPub:b,farmKeys:a,rewardInfo:d});u.addInstruction({instructions:[I],instructionTypes:[Z.FarmV6Restart]})}return u.versionBuild({txVersion:o})}async addNewRewardToken(t){let{txVersion:r,farmInfo:n,newRewardInfo:o,payer:i}=t,s=Pe[n.programId];s!==6&&this.logAndCreateError("invalid farm version ",s);let a=we((await this.scope.api.fetchFarmKeysById({ids:n.id}))[0]),c=i!=null?i:this.scope.ownerPubKey,u=this.createTxBuilder(),l=o.mint.equals(re)?new j(se.address):o.mint,d=ot({programId:new j(n.programId),poolId:new j(n.id),mint:l,type:"rewardVault"}),{rewardPubKey:f,newInstruction:p}=await this._getUserRewardInfo({rewardInfo:o,payer:c});return p&&u.addInstruction(p),f||this.logAndCreateError("annot found target token accounts",this.scope.account.tokenAccounts),o.mint=l,u.addInstruction({instructions:[Pr({payer:this.scope.ownerPubKey,userRewardTokenPub:f,farmKeys:a,rewardVault:d,rewardInfo:o})],instructionTypes:[Z.FarmV6CreatorAddReward]}).versionBuild({txVersion:r})}async addNewRewardsToken(t){let{txVersion:r,farmInfo:n,newRewardInfos:o,payer:i}=t,s=Pe[n.programId];s!==6&&this.logAndCreateError("invalid farm version ",s);let a=we((await this.scope.api.fetchFarmKeysById({ids:n.id}))[0]),c=i!=null?i:this.scope.ownerPubKey,u=this.createTxBuilder();for(let l of o){let d=l.mint.equals(re)?new j(se.address):l.mint,f=ot({programId:new j(n.programId),poolId:new j(n.id),mint:d,type:"rewardVault"}),{rewardPubKey:p,newInstruction:m}=await this._getUserRewardInfo({rewardInfo:l,payer:c});m&&u.addInstruction(m),p||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let y=Pr({payer:this.scope.ownerPubKey,userRewardTokenPub:p,farmKeys:a,rewardVault:f,rewardInfo:ee(X({},l),{mint:d})});u.addInstruction({instructions:[y],instructionTypes:[Z.FarmV6CreatorAddReward]})}return u.versionBuild({txVersion:r})}async deposit(t){let{txVersion:r,farmInfo:n,amount:o,feePayer:i,useSOLBalance:s,associatedOnly:a=!0,checkCreateATAOwner:c=!1,userAuxiliaryLedgers:u,computeBudgetConfig:l}=t;this.scope.availability.addFarm===!1&&this.logAndCreateError("farm deposit feature disabled in your region");let{rewardInfos:d,programId:f}=n,p=Pe[f];p===4&&this.logAndCreateError("V4 has suspended deposits:",n.programId),yr(p)||this.logAndCreateError("invalid farm program:",n.programId);let[m,y]=[new j(n.programId),new j(n.id)],b=(await this.scope.api.fetchFarmKeysById({ids:n.id}))[0],P=me({programId:m,poolId:y,owner:this.scope.ownerPubKey,version:p}),I=this.createTxBuilder();I.addCustomComputeBudget(l);let w={};for(let K of this.scope.account.tokenAccounts)if(a){let q=De(this.scope.ownerPubKey,K.mint,K.programId).publicKey;K.publicKey&&q.equals(K.publicKey)&&(w[K.mint.toString()]=K.publicKey)}else w[K.mint.toString()]=K.publicKey;let T=b.lpMint,A=w[T.address];A||this.logAndCreateError("you don't have any lp","lp zero",w);let k=[];for(let K of d){let q=s&&K.mint.address===ge.toString(),H=w[K.mint.address];if(!H){let{account:W,instructionParams:We}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:K.mint.programId,mint:new j(K.mint.address),notUseTokenAccount:q,createInfo:{payer:i||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!q,associatedOnly:q?!1:a,checkCreateATAOwner:c});H=W,We&&I.addInstruction(We)}w[K.mint.address]=H,k.push(H)}let C,R=await this.scope.connection.getAccountInfo(P);if(R&&(C=wr(p).decode(R.data)),n.programId!==Xe.toString()&&!C){let{instruction:K,instructionType:q}=xr({id:y,programId:m,version:p,ledger:P,owner:this.scope.ownerPubKey});I.addInstruction({instructions:[K],instructionTypes:[q]})}let L=hr({version:p,rewardInfos:d,rewardTokenAccountsPublicKeys:k});L&&this.logAndCreateError(L);let U={amount:N(o),owner:this.scope.ownerPubKey,farmInfo:n,farmKeys:b,lpAccount:A,rewardAccounts:k,userAuxiliaryLedgers:u==null?void 0:u.map(K=>new j(K))},O=p===6?vn(U):p===5?Nn(U):Mn(U),M={3:Z.FarmV3Deposit,5:Z.FarmV5Deposit,6:Z.FarmV6Deposit};return I.addInstruction({instructions:[O],instructionTypes:[M[p]]}).versionBuild({txVersion:r})}async withdraw(t){let{txVersion:r,farmInfo:n,amount:o,deposited:i,useSOLBalance:s,feePayer:a,associatedOnly:c=!0,checkCreateATAOwner:u=!1,userAuxiliaryLedgers:l,computeBudgetConfig:d}=t,{rewardInfos:f}=n;this.scope.availability.removeFarm===!1&&this.logAndCreateError("farm withdraw feature disabled in your region");let p=Pe[n.programId];yr(p)||this.logAndCreateError("invalid farm program:",n.programId);let m=(await this.scope.api.fetchFarmKeysById({ids:n.id}))[0],y=this.createTxBuilder();y.addCustomComputeBudget(d);let b={};for(let L of this.scope.account.tokenAccounts)if(c){let U=De(this.scope.ownerPubKey,L.mint).publicKey;L.publicKey&&U.equals(L.publicKey)&&(b[L.mint.toString()]=L.publicKey)}else b[L.mint.toString()]=L.publicKey;if(p!==4){let L=me({programId:new j(n.programId),poolId:new j(n.id),owner:this.scope.ownerPubKey,version:p}),U=await this.scope.connection.getAccountInfo(L);if(U)wr(p).decode(U.data).deposited.isZero()&&this.logAndCreateError("no deposited lp",{farmId:n.id});else if(p!==6){let{instruction:O,instructionType:M}=xr({id:new j(m.id),programId:new j(m.programId),version:p,ledger:L,owner:this.scope.ownerPubKey});y.addInstruction({instructions:[O],instructionTypes:[M]})}}i&&i.isZero()&&!(l||[]).length&&this.logAndCreateError("no deposited lp",{farmId:n.id});let P=m.lpMint.address,I=s&&P===ge.toString(),w=b[P.toString()];if(!w){let{account:L,instructionParams:U}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:m.lpMint.programId,mint:new j(P),notUseTokenAccount:I,createInfo:{payer:a||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!0,associatedOnly:I?!1:c,checkCreateATAOwner:u});w=L,U&&y.addInstruction(U)}b[P.toString()]=w;let T=[];for(let L of f){let U=s&&L.mint.address===ge.toString(),O=b[L.mint.address];if(!O){let{account:M,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:L.mint.programId,mint:new j(L.mint.address),notUseTokenAccount:U,createInfo:{payer:a||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!U,associatedOnly:U?!1:c,checkCreateATAOwner:u});O=M,K&&y.addInstruction(K)}b[L.mint.address]=O,T.push(O)}let A=hr({version:p,rewardInfos:f,rewardTokenAccountsPublicKeys:T});A&&this.logAndCreateError(A);let k={amount:N(o),owner:this.scope.ownerPubKey,farmInfo:n,farmKeys:m,lpAccount:w,rewardAccounts:T,userAuxiliaryLedgers:l==null?void 0:l.map(L=>new j(L))},C=p===6?kr(k):p===5?Ar(k):p===4?_n(k):Ir(k),R={3:Z.FarmV3Withdraw,4:Z.FarmV4Withdraw,5:Z.FarmV5Withdraw,6:Z.FarmV6Withdraw};return y.addInstruction({instructions:[C],instructionTypes:[R[p]]}).versionBuild({txVersion:r})}async withdrawFarmReward({farmInfo:t,withdrawMint:r,txVersion:n,computeBudgetConfig:o}){var p;this.scope.checkOwner();let i=we((await this.scope.api.fetchFarmKeysById({ids:t.id}))[0]),s=Pe[t.programId];s!==6&&this.logAndCreateError("invalid farm version",s);let a=i.rewardInfos.find(m=>ut(m.mint.address).equals(ut(r)));a||this.logAndCreateError("withdraw mint error","rewardInfos",t);let c=(p=a==null?void 0:a.vault)!=null?p:re,u=this.createTxBuilder(),l;if(r.equals(re)||r.equals(j.default)){let m=await ur({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:br(ee(X({},a),{openTime:a.openTime,endTime:a.endTime,perSecond:new Ut(a.perSecond).mul(10**a.mint.decimals).toString()}))});l=m.addresses.newAccount,u.addInstruction(m)}else{let m=await this.scope.account.getCreatedTokenAccount({mint:r});m===null?(l=await this.scope.account.getAssociatedTokenAccount(r),u.addInstruction({instructions:[ss(this.scope.ownerPubKey,l,this.scope.ownerPubKey,r)],instructionTypes:[Z.CreateATA]})):l=m}let{instruction:d,instructionType:f}=En({programId:i.programId,id:i.id,authority:i.authority,lpVault:i.lpVault,rewardVault:c,userRewardToken:l,owner:this.scope.ownerPubKey});return u.addCustomComputeBudget(o),u.addInstruction({instructions:[d],instructionTypes:[f]}).versionBuild({txVersion:n})}async harvestAllRewards(t){let{farmInfoList:r,useSOLBalance:n,feePayer:o,associatedOnly:i=!0,checkCreateATAOwner:s=!1,userAuxiliaryLedgers:a,txVersion:c,computeBudgetConfig:u}=t,l=this.createTxBuilder(),d={};for(let m of this.scope.account.tokenAccounts)if(i){let y=De(this.scope.ownerPubKey,m.mint).publicKey;m.publicKey&&y.equals(m.publicKey)&&(d[m.mint.toString()]=m.publicKey)}else d[m.mint.toString()]=m.publicKey;let p=(await this.scope.api.fetchFarmKeysById({ids:Object.values(r).map(m=>m.id).join(",")})).reduce((m,y)=>ee(X({},m),{[y.id]:y}),{});for(let m of Object.values(r)){let{programId:y,lpMint:b,rewardInfos:P,id:I}=m,w=Pe[y],T=b.address,A=n&&T===ge.toString(),k=d[T];if(!k){let{account:M,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:b.programId,mint:new j(T),notUseTokenAccount:A,createInfo:{payer:o||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!0,associatedOnly:A?!1:i,checkCreateATAOwner:s});k=M,K&&l.addInstruction(K)}d[T.toString()]=k;let C=[];for(let M of P){let K=n&&M.mint.address===ge.toString(),q=d[M.mint.address];if(!q){let{account:H,instructionParams:W}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:M.mint.programId,mint:new j(M.mint.address),notUseTokenAccount:K,createInfo:{payer:o||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!K,associatedOnly:K?!1:i,checkCreateATAOwner:s});q=H,W&&l.addInstruction(W)}d[M.mint.address]=q,C.push(q)}let R=p[I],L={amount:Qt,owner:this.scope.ownerPubKey,farmInfo:m,farmKeys:R,lpAccount:k,rewardAccounts:C,userAuxiliaryLedgers:a==null?void 0:a.map(M=>new j(M))},U=w===6?kr(L):w===5?Ar(L):Ir(L),O={3:Z.FarmV3Withdraw,5:Z.FarmV5Withdraw,6:Z.FarmV6Withdraw};l.addInstruction({instructions:[U],instructionTypes:[O[w]]})}return c===1?l.sizeCheckBuild({computeBudgetConfig:u}):l.sizeCheckBuildV0({computeBudgetConfig:u})}};export{Sr as default};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=farm.mjs.map